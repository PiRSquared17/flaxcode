Fri Dec 07 12:22:07 GMT 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/collection_list.py: If deleting the database fails, return
	  after a short break.  Report failure due to other exceptions
	  better, and don't mark a database as deleted if the deletion
	  fails.

Fri Dec 07 11:40:22 GMT 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py: Notify the collection list when an
	  index connection is opened or closed.
	* src/collection_list.py: Add the index connection information to
	  the handle count kept for each collection; avoids attempting to
	  delete underlying databases while a collection is finishing up
	  its indexing.

Fri Dec 07 11:16:21 GMT 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/collection_list.py: Delete the underlying database on disk
	  when the collection is deleted.  This involves several steps:
	   - first, we maintain a "handle count" of the number of handles
	     which are open on databases.  This is incremented whenever a
	     search connection is opened, and decremented when the
	     connection is closed again.  All access to this count is
	     protected by a Condition, which is signalled whenever the
	     count drops to zero.
	   - When a database is deleted, it is marked as deleted (to stop
	     any new connections being made), deleted from the _collections
	     member, and the path of the database is added to the
	     _collections_being_deleted member.
	   - When a database is deleted, a separate thread is started which
	     waits on the condition, and checks for the handle count of the
	     database being deleted dropping to zero.  When it does, the
	     database is deleted from disk.
	   - If the server is stopped before the database is deleted from
	     disk, the _collections_being_deleted entries will be read in
	     when the server is next started, and the database will then be
	     deleted.
	* src/doc_collection.py: Add a ready_to_be_indexed() method, which
	  checks that the collection is due and not held, and not deleted.
	  Change search_conn() uses CollectionList.get_search_connection()
	  to get the connection to the database, rather than doing it
	  directly, so that the connection gets registered.
	* src/indexserver/indexer.py: Remove ok_to_index() - call
	  DocCollection.ready_to_be_indexed() instead.
	* src/cpserver.py: Now that CollectionList.new_collection() returns
	  an error message if the collection name is already in use, use
	  that rather than testing ourselves.
	* src/search.py: Refer to the databases to be searched by names,
	  rather than paths.  Call CollectionList.get_search_connection()
	  to get the connection to the databases, rather than doing it
	  ourself, so that the connection gets registered.

Fri Dec 07 11:11:06 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flax_w32.py: Don't do "except:" - for now, just catch
	  Exception, which will stop any ProcessExit type exceptions being
	  stopped, but ideally we'd just catch the specific exception that
	  means that a registry key wasn't found.

Thu Dec 06 17:43:15 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/cpserver.py: Redirect after deleting a database, so that
	  refresh doesn't cause errors.

Thu Dec 06 13:23:00 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/collection_list.py,src/doc_collection.py,src/flax.py,
	  src/persist.py,src/startflax.py: Rework the way in which flax
	  settings are stored and restored from files. Instead of just
	  pickling (well, shelving) the flax.options object, add a
	  FlaxOptions::to_dict() method, which returns a dict which can
	  then be pickled.  Currently, the DocCollection objects are still
	  put into the dict natively, but everything else placed in the
	  dict is one of (string, list, tuple, dict).  Once the
	  DocCollection objects are resolved, we can start storing the
	  settings as a human-readable format, and can also be more robust
	  to change; we'll be able to read configuration files and upgrade
	  them, since reading them won't rely on the code used to create
	  them being the same as that used to read them. Update
	  configuration version number to 12.  Remove FlaxOptions.filters
	  property, which was never used (externally).  Change the
	  FlaxOptions.formats, FlaxOptions.logger_names and
	  FlaxOptions.languages to be class properties, since they're
	  dependent on the modules available, not user configuration.
	  (Really, they should be available as module properties, or
	  something like that, but this is a convenient way to separate
	  them for now, without requiring any of the code using them to be
	  updated.)  Add FlaxOptions.to_dict() and from_dict(), and convert
	  make_options() into a FlaxOptions.set_to_defaults() method. The
	  flax.options object is now created at module import time, and
	  never overwritten; this removes potential race conditions by
	  stopping it being accessed before being created.  Instead, the
	  persist module updates the options in-place. Add "deleted"
	  attribute to DocCollection objects - this will be used to mark
	  collections which are in the process of being deleted (but isn't
	  yet used - I just wanted to get it in now so I don't have to bump
	  the options file version number again). CollectionList no longer
	  takes a "formats" object: this was just a reference to the
	  formats object in flax.options, and as such can more cleanly be
	  accessed directly (this also makes it obvious that changes in
	  fax.options.formats will be reflected in any new databases
	  created).

Thu Dec 06 10:25:01 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=153 Don't call
	  cherrypy.server.stop as it sometimes blocks indefinitely.

Wed Dec 05 12:27:16 UTC 2007  charliejuggler

	* src/templates/admin_banner.html: fix help link; doesn't need a
	  target and correction to 'collections' page name

Wed Dec 05 11:53:55 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: fix ref manual path

Wed Dec 05 11:32:47 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/admin_banner.html: Added contextual help link. This
	  needs the ../docs folder to be copied into ./static

Wed Dec 05 11:22:28 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* docs/reference.html,docs/reference.rst: Minor tweaks

Wed Dec 05 11:00:12 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/filespec.py: In FileSpec.files - fixed the log message when a
	  file doesn't exist.

Wed Dec 05 10:52:52 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py: Import sys so we can call
	  sys.exitfunc()

Wed Dec 05 10:49:51 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: add ref manual & styles

Wed Dec 05 10:36:06 UTC 2007  charliejuggler

	* src/flaxservice.py,src/indexserver/indexer.py,src/startflax.py:
	  Call sys.exit_func rather than processing.exit_func to further
	  ensure all atexit handlers are called; also make sure we return
	  the correct code from FlaxMain.join() - fixes for #153

Wed Dec 05 10:32:06 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* docs/reference.html,docs/reference.rst: Removed reference to
	  stopwords

Wed Dec 05 10:19:11 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collection_detail.html,src/templates.py: Removed
	  stopwords

Wed Dec 05 09:39:07 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: imgs for ref manual

Tue Dec 04 21:05:47 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: Used "indexing" rather than
	  "indexing.control" as the logger for indexing control logging
	  information since the latter isn't explicitly configured.

Tue Dec 04 20:53:25 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/startflax.py: Added debugging log messages to monitor
	  shutdown process.

Tue Dec 04 16:36:42 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/doc_collection.py: Cosmetic changes: doccomment improvements
	  and mark an internal method with a leading _.

Tue Dec 04 16:32:01 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/search.py: Cosmetic change - use conn.OP_AND instead of
	  xappy.SearchConnection.OP_AND. (Makes it easier for me when
	  refactoring to be able to find all the places where
	  SearchConnections are created)

Mon Dec 03 13:29:13 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/indexserver/indexer.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=146 Stop
	  indexing a collection prior to deletion, ensure that we don't
	  consider deleted collections as candidates for indexing.

Mon Dec 03 09:30:37 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py: Add a comment, noting the place where
	  serious errors are likely to be thrown.

Fri Nov 30 16:17:33 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: added ref manual

Thu Nov 29 12:25:32 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* README: Fix typo.

Thu Nov 29 12:22:20 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* README: Added notes about setting the admin password.

Thu Nov 29 11:13:24 UTC 2007  paul.x.rudin@gmail.com

	* src/startflax.py: removed test code that was inadvertently
	  committed.

Thu Nov 29 10:58:43 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/schedulespec.py,src/test/testschedulespec.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=150
	  datetime.datetime.weekday is a method - so need to call it.

Wed Nov 28 15:03:17 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/startflax.py: split startup code into separate function to
	  facilitate testing.

Wed Nov 28 14:58:14 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: corrected typos in comments

Wed Nov 28 14:56:43 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: ## Lines starting with '## ' will be
	  removed from the log message. ## File(s) to commit recursively:
	  ## startflax.py FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=148 Ensure
	  that SystemExit is raised.

Wed Nov 28 14:37:05 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/startflax.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=148 When
	  running from the command line, explicitly call our shutdown code
	  on uncaught exceptions. This code isn't used when running as a
	  windows service so it has no implications for logging issues in
	  that circumstance.

Tue Nov 27 16:17:44 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* docs/reference.html: Generated HTML

Tue Nov 27 16:05:29 UTC 2007  charliejuggler

	* docs/reference.rst: Added information about resetting passwords
	  in Windows and a FAQ link to the Troubleshooting section.

Tue Nov 27 15:26:15 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* docs/html4css1.css,docs/img,docs/img/reference-1.png,
	  docs/img/reference-2.png,docs/img/reference-3.png,
	  docs/img/reference-4.png,docs/img/reference-5.png,
	  docs/reference.html,docs/reference.rst,docs/styles.css: Added
	  images and generated HTML

Mon Nov 26 14:44:24 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/docs/hacking.rst: Typos, formatting - some stuff on running
	  as a windows service.

Mon Nov 26 12:35:34 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flaxservice.py: Update comments to reflect our understanding
	  of why we don't need to tell the SCM that we've stopped.

Mon Nov 26 12:13:09 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py: Display type of exceptions raised by
	  filters, as well as their message.

Sun Nov 25 17:46:40 UTC 2007  paul.x.rudin@gmail.com

	* src/indexserver/indexer.py,src/util.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=127 If
	  available free disk space for a collection's database drops below
	  500000000 bytes then we raise an exception indicating that this
	  is a problem.

Fri Nov 23 16:40:04 UTC 2007  charliejuggler

	* w32setup/gettingstarted/GettingStartedOnWindows.htm: fixed email
	  address

Fri Nov 23 16:39:29 UTC 2007  charliejuggler

	* src/templates/about.html: missed para end

Fri Nov 23 16:38:44 UTC 2007  charliejuggler

	* src/templates/about.html: make About page agree with website

Fri Nov 23 15:50:18 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flaxloghandlers.py: Oops - pass self when calling superclass
	  methods.

Fri Nov 23 15:47:56 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flaxloghandlers.py: Override flush() and close() on the
	  loghandler, to avoid errors due to accessing a closed file at
	  shutdown.

Fri Nov 23 13:44:29 UTC 2007  charliejuggler

	* src/flaxservice.py: Attempting to call
	  ReportServiceStatus(win32service.SERVICE_STOPPED)at the very end
	  of SvcDoRun can cause an exception - removing it as it doesn't
	  seem to be needed.

Fri Nov 23 12:08:12 UTC 2007  paul.x.rudin@gmail.com

	* src/startflax.py: import time as it's used.

Fri Nov 23 11:58:58 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/startflax.py: Add import of threading to fix bug #145.

Fri Nov 23 11:28:27 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flax.py: Change default filters on windows - use Xapian for
	  HTML and Text for text.

Fri Nov 23 10:55:45 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: fix quotes

Fri Nov 23 10:14:46 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* w32setup/setup_svc.py: Use a raw multiline string, to avoid
	  having to escape all the backslashes.

Fri Nov 23 10:06:53 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: typos

Fri Nov 23 10:00:55 UTC 2007  charliejuggler

	* w32setup/gettingstarted/GettingStartedOnWindows.htm: smaller text
	  for prerelease

Fri Nov 23 09:59:01 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* w32setup/setup_svc.py: Convert multiple "print >> ofi" lines to a
	  single print with a multiline string.  Use named parameter
	  substitutions, and use self.__dict__ as the dictionary for these.

Fri Nov 23 09:33:34 UTC 2007  charliejuggler

	* w32setup/gettingstarted/GettingStartedOnWindows.htm,
	  w32setup/setup_svc.py: Add "prerelease"

Thu Nov 22 17:33:02 UTC 2007  charliejuggler

	* src/templates/collections.html: slight change of detail about
	  held collections

Thu Nov 22 14:41:06 UTC 2007  paul.x.rudin@gmail.com

	* src/indexserver/indexer.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=140 Changed
	  some log messages to debug so that "info" is less cluttered.

Thu Nov 22 14:34:03 UTC 2007  paul.x.rudin@gmail.com

	* src/flaxlog.conf,src/flaxloghandlers.py,
	  src/indexserver/indexer.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=134 Made a new
	  rotating file handler that avoids some problems with fileio from
	  handlers in different process that use the same file. Used this
	  in the default configuration.

Thu Nov 22 11:26:10 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/static/js/mapping.js,
	  src/templates/collection_detail.html: Fix to issue 139, plus
	  minor tweaks

Wed Nov 21 19:10:36 UTC 2007  charliejuggler

	* w32setup/HowToBuildFlaxStandaloneOnWindows.txt: extra bit to make
	  sure distutils doesn't use bits from earlier versions of Python

Wed Nov 21 18:34:48 UTC 2007  charliejuggler

	* w32setup/HowToBuildFlaxStandaloneOnWindows.txt: added comment
	  about Python 2.5.1 over 2.5

Wed Nov 21 18:19:14 UTC 2007  charliejuggler

	* src/flaxlog.conf: Remove space in loggers line - this breaks the
	  whole thing on WindowsXP/Python2.5 !!

Wed Nov 21 17:35:00 UTC 2007  paul.x.rudin@gmail.com

	* src/filespec.py,src/flaxlog.conf,src/indexserver/indexer.py,
	  src/indexserver/remote_filter.py,
	  src/indexserver/w32com_ifilter.py: Refactored the logging so that
	  different processes don't use the same handler so that we don't
	  use a rotated log file from different processes. However this is
	  not working as I expect so I've temporarily disabled the rotation
	  in flaxlog.conf until that problem is resolved.

Wed Nov 21 10:33:33 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/search.html,src/templates.py: Fixes for issue 137

Wed Nov 21 07:29:48 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/flaxlog.conf,src/indexserver/indexer.py,
	  src/indexserver/remote_filter.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=134 Changed
	  the logging so that the same rotating log handler is not used by
	  different processes.

Tue Nov 20 17:07:16 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/templates/search.html: Improved
	  standoutness of spelling correction warning

Tue Nov 20 16:43:32 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/flaxlog.conf: Just have one handler for all log messages.
	  Remove consolehandler and indexhandler since they're not used.
	  Give arguments to the main handler so that logs are rotated every
	  10Mb and 10 old copies are kept.

Tue Nov 20 15:26:06 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/cpserver.py: Allow multiple bits of the doc_id to be passed
	  to source() to cope with unix style paths, which cherrypy will
	  split on the '/'es.

Tue Nov 20 15:12:00 UTC 2007  charliejuggler

	* README: fix spelling mistakes

Tue Nov 20 14:49:11 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates.py: Add "for" attributes to collection checkbox
	  labels on the search pages, so that clicking on the names will
	  toggle the checkboxes.

Tue Nov 20 12:03:30 UTC 2007  charliejuggler

	* w32setup/install.ico: added 16 colour versions; seems to have
	  fixed #124

Tue Nov 20 11:39:20 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* w32setup/install.ico: Added 32x32 image

Tue Nov 20 11:26:51 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* w32setup/flax32x32.ico,w32setup/flax32x32.tif: 32x32 icon and
	  source

Tue Nov 20 11:14:21 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates.py: Fix for issue 131

Mon Nov 19 16:32:10 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: slightly better check for PDF Ifilter

Mon Nov 19 16:14:22 UTC 2007  charliejuggler

	* w32setup/HowToBuildFlaxStandaloneOnWindows.txt,
	  w32setup/setup_svc.py: Use the Visual C++ Redistributable
	  package, not individual DLLS - apart from msvcp71.dll which has
	  to be done manually.

Mon Nov 19 14:56:52 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: check for most recent PDF ifilter

Mon Nov 19 14:53:30 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/filespec.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=130 Ensured
	  that single file paths are treated correctly. Also logged an
	  error if a path is neither a file or a directory.

Mon Nov 19 14:18:39 UTC 2007  charliejuggler

	* w32setup/gettingstarted/GettingStartedOnWindows.htm: add caveat
	  about direct serving

Mon Nov 19 13:22:38 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: prevent IFilter checker being after every
	  page due to misplaced 'end;'

Mon Nov 19 12:36:37 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: Make sure default data folder is subfolder
	  of user's chosen install folder; also check for various IFilters
	  and attempt to fix the HTML one, or inform about RTF and PDF.

Mon Nov 19 12:03:58 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/templates/search.html,
	  src/templates.py: User is warned when searching an empty
	  collection (issue 119)

Mon Nov 19 12:01:20 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/docs/hacking.rst: Added a link to the wiki page on file types
	  representation.

Mon Nov 19 11:26:09 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/docs/hacking.rst: Added a list of the loggers we actually
	  use.

Mon Nov 19 10:56:13 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/cpserver.py: Added Expires header to json response to prevent
	  IE from caching data.

Mon Nov 19 10:40:06 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py: Catch KeyboardInterrupt as well as
	  SystemExit for neater log messages, and don't say that the
	  exception is being re-raised when it isn't. Also add some
	  debugging log lines, and tidy some comments.

Mon Nov 19 10:31:58 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* utils/install_dependencies.py: Use a modified archive of
	  processing 0.38 with a bug fix. Also modify
	  install_dependencies.py to cope with directory entries in zip
	  files, which this modified archive needs.

Mon Nov 19 07:56:34 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/collection_list.py: used logger "collections" rather than
	  "collection".

Mon Nov 19 07:11:10 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* README: removed information that is now elsewhere, brought stuff
	  up to date.

Mon Nov 19 06:34:46 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/epydoc.conf: corrected comment

Fri Nov 16 17:08:21 UTC 2007  charliejuggler

	* src/templates/collections.html: minor clarification

Fri Nov 16 17:00:50 UTC 2007  charliejuggler

	* w32setup/install.bmp,w32setup/install.ico,
	  w32setup/install_small.bmp,w32setup/setup_svc.py,
	  w32setup/uninstall.ico: add icons and bitmaps for installation

Fri Nov 16 16:32:33 UTC 2007  paul.x.rudin@gmail.com

	* src/doc_collection.py: changed the quoting of doc ids in
	  url_for_doc so we don't get '+' in place of ' '.

Fri Nov 16 16:16:41 UTC 2007  paul.x.rudin@gmail.com

	* src/indexserver/indexer.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=115 Caught and
	  logged SystemExit (and subclasses like ProcessExit) at a lower
	  severity level that other exceptions.

Fri Nov 16 16:12:45 UTC 2007  charliejuggler

	* w32setup/WindowsFAQ.txt: mistakenly committed, actually it's in
	  the Wiki

Fri Nov 16 16:12:10 UTC 2007  charliejuggler

	* w32setup/WindowsFAQ.txt:

Fri Nov 16 16:05:21 UTC 2007  paul.x.rudin@gmail.com

	* src/cpserver.py,src/doc_collection.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=115 Simplified
	  FLAX serving to just quote the doc_id - since we're doing it this
	  way we don't really need to treat the doc_id specially - just
	  quote it and pass it through.

Fri Nov 16 14:20:53 UTC 2007  charliejuggler

	* w32setup/startflaxservice.bat,w32setup/stopflaxservice.bat:
	  startflaxservice waits 3 seconds as before, stopflaxservice waits
	  6 seconds to allow files to become free to delete

Fri Nov 16 14:15:39 UTC 2007  charliejuggler

	* w32setup/startflaxservice.bat,w32setup/stopflaxservice.bat: 5
	  second delay as service may take this long to stop

Fri Nov 16 14:08:16 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: fix typo

Fri Nov 16 14:07:02 UTC 2007  charliejuggler

	* src/flaxservice.py: Make sure that in all cases we tell the
	  Service Manager when we stop

Fri Nov 16 13:08:54 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/util.py: disabled psyco, see:
	  http://code.google.com/p/flaxcode/issues/detail?id=125

Fri Nov 16 10:59:24 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: change messages on uninstall re upgrading

Fri Nov 16 10:58:44 UTC 2007  charliejuggler

	* w32setup/gettingstarted/GettingStartedOnWindows.htm: change flax
	  serving details

Thu Nov 15 16:43:45 UTC 2007  charliejuggler

	* src/templates/collections.html: buttons must have type="submit"
	  to work on IE

Thu Nov 15 16:37:25 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/doc_collection.py,src/templates/collection_detail.html,
	  src/templates.py: Implemented FLAX file-serve mapping

Thu Nov 15 15:44:21 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: install runtime DLLs to Windows system
	  folder correctly

Thu Nov 15 15:39:20 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collections.html: IE6 needs type=submit

Thu Nov 15 15:17:57 UTC 2007  charliejuggler

	* w32setup/startflaxservice.bat,w32setup/stopflaxservice.bat: way
	  of sleeping that works on Win2k upwards; better error handling

Thu Nov 15 15:17:32 UTC 2007  charliejuggler

	* w32setup/gettingstarted/GettingStartedOnWindows.htm: new way of
	  serving files

Thu Nov 15 15:03:35 UTC 2007  charliejuggler

	* w32setup/HowToBuildFlaxStandaloneOnWindows.txt,
	  w32setup/setup_svc.py: missing DLL

Thu Nov 15 14:33:38 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collection_detail.html: Added button to generate
	  Flax file-serve mapping

Thu Nov 15 10:06:45 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* docs,docs/reference.rst: Start of reference manual

Thu Nov 15 09:21:27 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collections.html: Collections list now polls
	  regardless of page content, so scheduled indexing is displayed

Thu Nov 15 09:20:33 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/js/MochiKit/Format.js,
	  src/static/js/MochiKit/MochiKit.js: Added Format module for
	  string utils

Thu Nov 15 08:30:27 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/docs/hacking.rst: added some notes on the templates.

Wed Nov 14 15:10:17 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collection_detail.html: Added Mon and Sun to
	  helptext

Wed Nov 14 14:55:14 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collection_detail.html: Added validation code for
	  scheduling

Wed Nov 14 14:32:51 UTC 2007  charliejuggler

	* src/flaxauth.py: make sure old auth file deleted before new one
	  created; fixes #118

Wed Nov 14 14:23:00 UTC 2007  charliejuggler

	* w32setup/gettingstarted/GettingStartedOnWindows.htm,
	  w32setup/gettingstarted/createcol7.jpg: add pic of search results

Wed Nov 14 13:39:59 UTC 2007  charliejuggler

	* src/templates/about.html: spellong misteack

Wed Nov 14 13:24:27 UTC 2007  charliejuggler

	* src/flax_w32.py: Change name

Wed Nov 14 13:17:11 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: typo

Wed Nov 14 13:13:22 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: change name

Wed Nov 14 13:10:16 UTC 2007  charliejuggler

	* src/templates/about.html: change name

Wed Nov 14 13:04:15 UTC 2007  charliejuggler

	* w32setup/gettingstarted/GettingStartedOnWindows.htm,
	  w32setup/gettingstarted/createcol3.jpg,
	  w32setup/gettingstarted/createcol4.jpg: simplified collection
	  creation; use house style

Wed Nov 14 12:18:20 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/doc_collection.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=115
	  Resurrected (and modified as necessary) code to serve source
	  files from Flax directly. Changed the way the file is identified
	  so that it's possible to access this just by putting in an
	  appropriate mapping for a path.

Wed Nov 14 12:11:01 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/dbspec.py: Tidied default values in update()

Wed Nov 14 11:11:58 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/startflax.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=67 Refactored
	  the way we stop and join so that the work involved in stopping
	  happens in a separate thread so that we can correctly implemented
	  the intended behaviour of join with a timeout.

Wed Nov 14 11:08:33 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: Allowed for a timeout to the join
	  method of IndexServer (although it's not used at the moment).

Wed Nov 14 11:00:05 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/js/mapping.js: Fixed bug 116

Wed Nov 14 10:47:33 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collection_detail.html: Validates collection name
	  in JS

Wed Nov 14 10:30:07 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/cpserver.py: Added collection name validation to server

Wed Nov 14 10:05:20 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/templates/admin_banner.html: Fixed
	  issue 103, caused by incorrectly closed span

Wed Nov 14 10:04:23 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collection_detail.html: Prevent JS error message on
	  edit details page

Tue Nov 13 17:36:33 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: add link to getting started from final
	  page

Tue Nov 13 17:31:03 UTC 2007  charliejuggler

	* w32setup/gettingstarted/GettingStartedOnWindows.htm:

Tue Nov 13 17:19:03 UTC 2007  charliejuggler

	* w32setup/gettingstarted,
	  w32setup/gettingstarted/GettingStartedOnWindows.htm,
	  w32setup/gettingstarted/admin1.jpg,
	  w32setup/gettingstarted/createcol1.jpg,
	  w32setup/gettingstarted/createcol2.jpg,
	  w32setup/gettingstarted/createcol3.jpg,
	  w32setup/gettingstarted/createcol4.jpg,
	  w32setup/gettingstarted/createcol6.jpg: Draft Getting Started on
	  Windows

Tue Nov 13 16:44:48 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/img/flax.125trans.png,
	  src/static/img/flax.250trans.png: Changed name to Flax Basic

Tue Nov 13 15:46:01 UTC 2007  charliejuggler

	* w32setup/exampledocs,w32setup/exampledocs/First document.txt,
	  w32setup/exampledocs/Second document.htm,
	  w32setup/exampledocs/Third document.doc: Some example data for
	  use in the Getting Started guide

Tue Nov 13 11:35:17 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/docs/hacking.rst: snapshot

Mon Nov 12 22:17:04 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/docs/hacking.rst: Various spelling, typo and capitalisation
	  corrections.

Mon Nov 12 18:50:43 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/docs/hacking.rst: Moved the text from some wiki pages here
	  and updated it.

Mon Nov 12 12:09:50 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: removed references to the pypdf
	  filter which were inadvertently left in.

Mon Nov 12 06:50:41 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: removed a debugging print.

Mon Nov 12 06:50:00 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: Fixed a potential problem with
	  synchronisation between threads when starting up a new indexing.

Mon Nov 12 06:25:52 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: corrected typo in log message

Sun Nov 11 22:31:56 UTC 2007  paul.x.rudin@gmail.com

	* src/test/pdf_filtering.py: Added basic logging configuration so
	  that log output can be seen during testing.

Sun Nov 11 21:51:22 UTC 2007  paul.x.rudin@gmail.com

	* src/flaxlog.conf: Set the default propagation to 0 for all
	  loggers to avoid repeated log messages at the default settings.

Sun Nov 11 15:27:20 UTC 2007  paul.x.rudin@gmail.com

	* src/indexserver/w32com_ifilter.py:
	  http://code.google.com/p/flaxcode/issues/detail?id=109 Added some
	  logging (not that "DEBUG" level for this filter will now give all
	  the text it's yielding") Continued through the "unspecified" com
	  errors, since this seems to work. I've added a check that we
	  don't try and repeat the same chunk in case this exception is
	  raised in other situations where the same chunk might be repeated
	  once this exception is raised.

Fri Nov 09 17:15:00 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: minor fix to make sure we stop the service
	  if the user doesn't want to remove the data

Fri Nov 09 16:18:34 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: Now asks if you want to remove data and
	  all other files (#94)

Fri Nov 09 15:00:57 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collection_detail.html,src/templates.py: Added file
	  paths to form validation, also prevented extra blank path/mapping
	  fields being added in edit

Fri Nov 09 14:59:28 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: don't replace .conf files if they already
	  exist - user may be trying to keep data and config

Fri Nov 09 14:43:57 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: Added message about setting password to
	  warn user, and page for choosing data directory (issue #74)

Fri Nov 09 12:35:47 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/uistrings.py: Fix a warning from epydoc.

Fri Nov 09 12:32:47 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collection_detail.html,src/templates.py: Increased
	  size of description input

Fri Nov 09 12:06:47 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/docs/hacking.rst,src/epydoc.conf: snapshot.

Fri Nov 09 12:05:36 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/cpserver.py,src/templates/collection_detail.html: Fixed
	  cpserver.py to detect empty collection name, and added JS form
	  validation to the template. (issue 104).

Fri Nov 09 09:19:18 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* w32setup/setup_svc.py: Put back the rules for the MochiKit dir -
	  they were removed by the last commit, but I assume that was a
	  mistake, because the log message didn't mention removing them.

Fri Nov 09 08:07:16 UTC 2007  paul.x.rudin@gmail.com

	* src/indexserver/indexer.py,src/startflax.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=90 Implemented
	  a DIY process stopping strategy. There are still things I don't
	  entirely understand about why other mechanisms failed to work -
	  see the comments in the code.

Thu Nov 08 17:19:59 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/doc_collection.py: Remove unused "source_file_from_id"
	  method.  Stop caching _search_conn, since it's not threadsafe.
	  Remove __getstate__ method, since we no longer have to do
	  anything special in it.

Thu Nov 08 16:55:19 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/startflax.py: Make FlaxMain into a new-style class, for
	  consistency with all our other classes.

Thu Nov 08 16:33:20 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/doc_collection.py: Only try to open the connection once -
	  don't create a new (empty) database if the database is missing.

Thu Nov 08 16:32:26 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/collection_list.py: Rename dbs_to_search to
	  dbpaths_to_search, for clarity.

Thu Nov 08 16:30:52 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/search.py: Rename dbs to dbpaths for clarity, and fix an out
	  of date documentation comment.

Thu Nov 08 16:19:33 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates/collections.html: Fix spelling of independent.

Thu Nov 08 16:14:51 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates/user_banner.html: Don't let individual labels get
	  split over lines.  Improves the appearance if the user fiddles
	  with font sizes.

Thu Nov 08 14:55:50 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/pypdf_filter.py: simple filter for pdfs using
	  pypdf

Thu Nov 08 13:35:01 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collections.html: Changed help wording a bit

Thu Nov 08 13:06:46 UTC 2007  paul.x.rudin@gmail.com

	* src/indexserver/w32com_ifilter.py: Took out the call to
	  pythoncom.CoInitializeEx(pythoncom.COINIT_APARTMENTTHREADED) and
	  associated paraphanelia, since it's apparently only needed in
	  threads other than the main thread. Added a comment about
	  circumstances under which it may need to be called.

Thu Nov 08 12:46:07 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collections.html,src/templates.py: Changed indexing
	  state back to Due, to avoid confusion with timed scheduling

Thu Nov 08 12:07:51 UTC 2007  paul.x.rudin@gmail.com

	* src/test/pdf_filtering.py: added a test for repeatedly filtering
	  a problem pdf remotely

Thu Nov 08 12:05:13 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/templates/collections.html: Unified
	  the look of inline help

Thu Nov 08 11:06:14 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/templates/search.html: Beautified
	  advanced options

Thu Nov 08 10:42:25 UTC 2007  paul.x.rudin@gmail.com

	* src/test/pdf_filtering.py,
	  src/test/sampledocs/problem_docs/ukpga_19960008_en.pdf: Simple
	  test to illustrate a problem with filtering some pdfs.

Thu Nov 08 09:58:17 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/docs/hacking.rst: snapshot

Thu Nov 08 09:08:44 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/docs/hacking.rst: snapshot

Thu Nov 08 08:20:05 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cplogger.py: added a module docstring

Thu Nov 08 07:16:10 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* docs,src/docs,src/docs/hacking.rst: moving to facilitate
	  integration with epydoc generated output

Thu Nov 08 07:11:20 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* docs/hacking.rst: snapshot

Thu Nov 08 06:00:09 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/epydoc.conf: add comments, and one missing file

Thu Nov 08 05:56:21 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/epydoc.conf: include all the current code in the modules
	  list.

Thu Nov 08 05:07:33 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/templates.py: Brought comments into line with
	  code.

Wed Nov 07 19:40:37 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* docs,docs/hacking.rst:
	  http://code.google.com/p/flaxcode/issues/detail?id=79 Start on
	  overview docs.

Wed Nov 07 18:03:54 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates.py: Use highlight query, to fix issue 85.

Wed Nov 07 17:45:56 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/search.py: Calculate the query to use for highlighting, and
	  store it separately from the query to run.

Wed Nov 07 17:15:19 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates.py: Lists more of collection description, now we
	  have more room

Wed Nov 07 17:12:09 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates.py: Tweak to JS text

Wed Nov 07 17:09:45 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates.py: Fix for issue 84

Wed Nov 07 16:55:56 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates/search.html: Move labels to the right of the check
	  boxes. Also, fix a dodgy SGML comment (had some -- markers in it)

Wed Nov 07 16:53:09 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates/search.html: Add "for" attributes for the format
	  labels on this page, too.

Wed Nov 07 16:50:20 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates/collection_detail.html: Added "for" attributes to
	  the collection detail, so that the labels are clickable.

Wed Nov 07 16:44:24 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collection_detail.html: Neater formats list

Wed Nov 07 16:37:01 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collection_detail.html,src/templates.py: JS tweak
	  to put focus in first field

Wed Nov 07 16:26:58 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py: Removed automatic setting of indexing due after
	  changes to a collection, and redirected to the collection list
	  view.

Wed Nov 07 16:24:40 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py: Log any unhandled exception from the
	  indexer process (as a critical error) before exiting, rather than
	  sending it to stderr or stdout.

Wed Nov 07 16:13:38 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collections.html: Properly fixed this time

Wed Nov 07 16:07:13 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collections.html: JS now checks for collection row
	  existence before updating, to prevent back-button error

Wed Nov 07 15:48:19 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collections.html: More tolerant of AJAX errors

Wed Nov 07 15:46:45 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py:
	  http://code.google.com/p/flaxcode/issues/detail?id=95 Added a
	  call to start_indexing at the end of IndexServer.do_indexing() to
	  ensure that if there is another collection due for indexing we
	  kick it off immediately.

Wed Nov 07 15:39:05 UTC 2007  charliejuggler

	* w32setup/HowToBuildFlaxStandaloneOnWindows.txt,
	  w32setup/setup_svc.py: don't need to explicitly copy _xapian.pyd,
	  distutils should pick it up

Wed Nov 07 15:30:09 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/search.py:
	  http://code.google.com/p/flaxcode/issues/detail?id=72 Chnaged the
	  code for dealing with specific filetypes to build a query using
	  query_field and query_composite.

Wed Nov 07 14:45:43 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collections.html,src/templates.py: Changed Held
	  wording

Wed Nov 07 14:38:43 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* LICENSE: Mention the MochiKit files.

Wed Nov 07 14:34:25 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collections.html: Slight correction to help text

Wed Nov 07 14:32:52 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* w32setup/setup_svc.py: Add the MochiKit directory.

Wed Nov 07 14:30:11 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/cpserver.py,src/static/css/main.css,
	  src/templates/collections.html,src/templates/flax.html,
	  src/templates.py: Changes to Collections page, including AJAX
	  update of status info

Wed Nov 07 14:28:15 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/js/MochiKit,src/static/js/MochiKit/Async.js,
	  src/static/js/MochiKit/Base.js,src/static/js/MochiKit/DOM.js,
	  src/static/js/MochiKit/Iter.js,
	  src/static/js/MochiKit/MochiKit.js,
	  src/static/js/MochiKit/__package__.js: Cut down version of
	  MochiKit with just the bits we use

Wed Nov 07 14:10:45 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py: Move the "conn.close()" call out of
	  the finally block, so that it's not called if an error occurs.
	  This should allow a faster shutdown if KeyboardError is raised,
	  and we don't really need to keep the unflushed changes if an
	  error has occurred. Also, add a try:finally clause to
	  IndexProcess.run() which calls processing.process._exit_func(),
	  to try and ensure that children get cleaned up when running as a
	  service (to work around the "exit handlers not being called when
	  run as a service" bug).

Wed Nov 07 14:04:53 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py: Trivial fix to a comment.

Wed Nov 07 12:38:12 UTC 2007  paul.x.rudin@gmail.com

	* src/indexserver/indexer.py: Added a logging info call to show the
	  pid of the indexer process.

Wed Nov 07 12:15:43 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: Abort with message if Flax is already
	  installed

Wed Nov 07 11:57:30 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* w32setup/setup_svc.py: Add some vague attribution to the start of
	  the file.

Wed Nov 07 10:27:43 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/test/issue72.py: Fix to work.

Wed Nov 07 09:04:55 UTC 2007  paul.x.rudin@gmail.com

	* src/indexserver/indexer.py:
	  http://code.google.com/p/flaxcode/issues/detail?id=62 In
	  Indexer.do_indexing logged the traceback rather than printing it.

Wed Nov 07 08:59:30 UTC 2007  paul.x.rudin@gmail.com

	* src/flaxlog.conf:
	  http://code.google.com/p/flaxcode/issues/detail?id=62 Ensured
	  that consolehandler is not used by default. It's not compatible
	  with running as a non-console windows application (e.g. running
	  as a windows service).

Wed Nov 07 08:56:45 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cplogger.py: Made logging __call__ process arguments
	  appropriately.

Wed Nov 07 08:22:18 UTC 2007  paul.x.rudin@gmail.com

	* src/cpserver.py: Reinstated commented out line for webserver
	  logging config.

Wed Nov 07 06:55:46 UTC 2007  paul.x.rudin@gmail.com

	* w32setup/setup_svc.py: removed spurious double quotes after
	  "[UninstallRun]" that cause an error when processing Flax Site
	  Search.iss. (You could tell that that was a file name if it
	  didn't have spaces in it :))

Tue Nov 06 17:41:19 UTC 2007  charliejuggler

	* src/templates/about.html: another feature

Tue Nov 06 17:06:59 UTC 2007  charliejuggler

	* src/version.py: fix typo, so correct format revision number
	  returned

Tue Nov 06 17:03:02 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: put extra .pyds in localinst/

Tue Nov 06 17:00:48 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flaxservice.py: Add setuppaths import to start of
	  flaxservice, just to ensure that everything gets found.

Tue Nov 06 16:54:49 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* utils/install_dependencies.py: Update version of processing.

Tue Nov 06 16:44:35 UTC 2007  charliejuggler

	* src/static/img/xapian-powered.png: for about page

Tue Nov 06 16:44:04 UTC 2007  charliejuggler

	* src/templates/about.html: first stab at a better About page

Tue Nov 06 13:15:55 UTC 2007  charliejuggler

	* w32setup/HowToBuildFlaxStandaloneOnWindows.txt: more details of
	  where DLLs come from and removed second mention of zlib1.dll

Tue Nov 06 12:58:45 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: set password on installation

Tue Nov 06 12:09:06 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/flax.html: Re-added onload event

Tue Nov 06 11:34:23 UTC 2007  charliejuggler

	* w32setup/HowToBuildFlaxStandaloneOnWindows.txt: added notes on
	  Perl and SVN

Tue Nov 06 11:04:32 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates.py: no banner_search element now

Tue Nov 06 11:02:25 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/templates/about.html,
	  src/templates/admin_banner.html,src/templates/search.html,
	  src/templates/user_banner.html: Fixed issue 77

Tue Nov 06 09:53:50 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/flaxlog.conf: workaround for Mac python

Tue Nov 06 06:47:12 UTC 2007  paul.x.rudin@gmail.com

	* src/indexserver/htmltotext_filter.py: Added setuppaths import

Mon Nov 05 23:34:56 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* w32setup/HowToBuildFlaxStandaloneOnWindows.txt: I'm pretty sure
	  we want the "py2exe" command, not the "install" command.

Mon Nov 05 23:33:31 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/auth.conf,src/startflax.py: Remove auth.conf from SVN, and
	  make startflax.py work fine if auth.conf is missing when the
	  --set-admin-password option is supplied (for other invocations,
	  the auth.conf file is required and will cause a fatal error if
	  it's missing).

Mon Nov 05 23:32:16 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/getsvnrev.py,src/version.py: Tweak format of version numbers
	  to be suitable for passing to distutils.

Mon Nov 05 23:31:26 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src: Ignore auth.conf

Mon Nov 05 23:03:03 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* w32setup/setup_svc.py: Update the version.py file before freezing
	  it, so the SVN revision reported by it will be correct.

Mon Nov 05 13:00:20 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* w32setup/HowToBuildFlaxStandaloneOnWindows.txt: Some more minor
	  corrections.

Mon Nov 05 12:41:24 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* w32setup/HowToBuildFlaxStandaloneOnWindows.txt: Further hack
	  needed.

Mon Nov 05 12:20:09 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* w32setup/HowToBuildFlaxStandaloneOnWindows.txt: Update numbering

Mon Nov 05 12:17:03 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* w32setup/HowToBuildFlaxStandaloneOnWindows.txt: Add another step
	  which is currently needed.

Mon Nov 05 12:14:06 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cplogger.py,src/cpserver.py,src/flax.py,src/flaxlog.conf:
	  Made a special logging manager for the cherrpy infrastructure
	  that intergrates well with the rest of the logging system.

Mon Nov 05 12:07:35 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* w32setup/HowToBuildFlaxStandaloneOnWindows.txt: Corrections.

Mon Nov 05 10:57:11 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/auth.conf,src/cp.conf,src/flaxauth.py,src/flaxpaths.py,
	  src/startflax.py: Store authentication tokens (ie,
	  username/password) in a separate file.  Add flaxauth module to
	  manage them, and reference this from the cp.conf file to get the
	  passwords.  Finish implementation of --set-admin-password option.

Mon Nov 05 09:31:29 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cp.conf: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=52 Disable
	  cherrypy autoreload in cp.conf. If people want to work with it
	  turned on locally then just modify your local copy.

Mon Nov 05 09:26:51 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/collection_detail.html,src/templates/options.html:
	  Fixes: http://code.google.com/p/flaxcode/issues/detail?id=70
	  Renamed submit buttons to "Apply".

Mon Nov 05 08:32:21 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/test/issue72.py: added comments/diagnostic print.

Mon Nov 05 08:24:20 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/test/issue72.py,src/test/sampledocs/issue72,
	  src/test/sampledocs/issue72/bar.htm,
	  src/test/sampledocs/issue72/foo.html: Added a test for issue 72

Sun Nov 04 11:57:35 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/doc_collection.py,src/filespec.py,src/search.py,
	  src/templates/collection_detail.html:
	  http://code.google.com/p/flaxcode/issues/detail?id=72 Changes to
	  support issue 72.

Sat Nov 03 08:28:47 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: Don't include the '.' in the
	  filetype.

Fri Nov 02 16:23:23 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/filespec.py,src/static/css/main.css,
	  src/templates/collection_detail.html,src/templates/search.html,
	  src/templates.py: More changes for
	  http://code.google.com/p/flaxcode/issues/detail?id=72

Fri Nov 02 13:21:09 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/startflax.py: Keep asking for a password until a valid one is
	  entered, twice.

Fri Nov 02 12:08:03 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/getsvnrev.py,src/version.py: Fix a fix issues when running
	  getsvnrev (including better handling of errors when running the
	  svn tools). Make version.py use getsvnrev, or the stored
	  svnrevision.py file, to get the svn revision, instead of using an
	  SVN keyword.

Fri Nov 02 11:48:35 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/templates/collections.html: table
	  border faked for IE7, ugh

Fri Nov 02 11:38:49 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src,src/getsvnrev.py: Add a script to generate a svnrevision.py
	  file, and add ignores for that file.

Fri Nov 02 11:27:26 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/templates/collections.html,
	  src/templates.py: fix for issue 51

Fri Nov 02 10:50:51 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/templates/collections.html: styled
	  del collection button better

Fri Nov 02 04:49:03 UTC 2007  paul.x.rudin@gmail.com

	* src/test/sampledocs/Ukpga_19880002_en_1.htm: for testing

Fri Nov 02 04:48:38 UTC 2007  paul.x.rudin@gmail.com

	* src/collection_list.py,src/cpserver.py,src/dbspec.py,
	  src/indexserver/indexer.py,src/search.py,
	  src/templates/search.html,src/templates.py:
	  http://code.google.com/p/flaxcode/issues/detail?id=72
	  Snapshotting progress for issue 72 work. Still need to change the
	  way formats are displayed in the UI, and verify that it actually
	  filters as intended.

Thu Nov 01 16:58:27 UTC 2007  charliejuggler

	* w32setup/HowToBuildFlaxStandaloneOnWindows.txt: further comments
	  on building Xapian

Thu Nov 01 11:27:59 UTC 2007  paul.x.rudin@gmail.com

	* src/indexserver/remote_filter.py: implemented a restart limit for
	  the remote_filter process - this is to partially address the
	  problem of filters that leak memory. Also in FilterRunner.run -
	  took the generation of the results inside the try block. Formerly
	  the actual iteration was outside the try so exceptions were not
	  necessailry caught if they were raised during the generation of
	  blocks rather than setting up the filter.

Thu Nov 01 10:54:47 UTC 2007  paul.x.rudin@gmail.com

	* src/indexserver/remote_filter.py: more logging.

Thu Nov 01 09:38:59 UTC 2007  paul.x.rudin@gmail.com

	* src/indexserver/remote_filter.py:
	  http://code.google.com/p/flaxcode/issues/detail?id=56
	  http://code.google.com/p/flaxcode/issues/detail?id=71 Added
	  additional checks to see whether the remote process is still
	  running and to deal with exceptions raised by a filter running in
	  a remote process. If the remote process raises an uncaught
	  exception kill it and restart. This ensures that the next
	  document won't timeout because the remote process has become
	  unresponsive. It also deal partially with the problem of growing
	  memory use due (we think) to a problem with the adobe IFilter.
	  Added some logging calls.

Wed Oct 31 18:25:02 UTC 2007  paul.x.rudin@gmail.com

	* src/test/issue71.py: added more comments.

Wed Oct 31 18:18:02 UTC 2007  paul.x.rudin@gmail.com

	* src/test/issue71.py: More simple experiments - suggesting that
	  the problem might be specifically to do with the pdf IFilter.

Wed Oct 31 18:09:15 UTC 2007  charliejuggler

	* w32setup/HowToBuildFlaxStandaloneOnWindows.txt: note about M$
	  redistributable files

Wed Oct 31 17:34:53 UTC 2007  paul.x.rudin@gmail.com

	* src/test/issue71.py: added a function to repeatedly call a remote
	  ifilter on a pdf

Wed Oct 31 17:32:40 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: remove Windows dir

Wed Oct 31 16:47:15 UTC 2007  charliejuggler

	* w32setup/setup_svc.py: make sure setup.exe has correct version
	  information

Wed Oct 31 16:24:45 UTC 2007  charliejuggler

	* w32setup/HowToBuildFlaxStandaloneOnWindows.txt,w32setup/flax.iss,
	  w32setup/makew32svc.bat,w32setup/setup_svc.py: Now setup_svc.py
	  does all the hard work, remove handcoded .iss and .bat files

Wed Oct 31 16:23:53 UTC 2007  charliejuggler

	* src/flaxservice.py: close files opened for stdout and stderr, for
	  tidyness

Wed Oct 31 15:54:42 UTC 2007  paul.x.rudin@gmail.com

	* src/test/sampledocs,src/test/sampledocs/Changes.txt,
	  src/test/sampledocs/problem_docs,
	  src/test/sampledocs/ukpga_20060041_en.pdf: moving

Wed Oct 31 15:54:17 UTC 2007  paul.x.rudin@gmail.com

	* tests: moving

Wed Oct 31 15:51:22 UTC 2007  paul.x.rudin@gmail.com

	* tests/sampledocs/problem_docs,
	  tests/sampledocs/problem_docs/ukpga_20060042_en.pdf:

Wed Oct 31 15:50:50 UTC 2007  paul.x.rudin@gmail.com

	* tests/sampledocs/ukpga_20060041_en.pdf: a pdf from the hmso for
	  testing.

Wed Oct 31 12:45:48 UTC 2007  charliejuggler

	* src/flaxservice.py: Added exception handlers in attempt to fix
	  #67

Wed Oct 31 11:58:24 UTC 2007  charliejuggler

	* w32setup/flax.iss,w32setup/makew32svc.bat,
	  w32setup/startflaxservice.bat,w32setup/stopflaxservice.bat: Can
	  now add/remove/start/stop Service during (un)installation

Wed Oct 31 11:13:21 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/test/issue71.py: issue 71 related code snippets.

Wed Oct 31 10:26:20 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/flaxpaths.py: Added a call to paths.set_dirs to facilitate
	  testing.

Tue Oct 30 18:47:09 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/static/css/main.css,src/templates/about.html,
	  src/templates/admin_banner.html,src/templates/search.html,
	  src/templates/user_banner.html,src/templates.py: Link to the
	  "about" pages, and integrate them with the navigation stuff.

Tue Oct 30 16:43:41 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/cpserver.py,src/templates/about.html,
	  src/templates/index.html,src/templates.py: Add an about page (to
	  both admin and user pages).  Not yet linked in.  Add lots of
	  documentation comments, and reformat a few bits of messy code and
	  whitespace.  Also, rename "real_id" to "nav_id", since it's only
	  used for navigation, and add a documentation comment describing
	  it.

Tue Oct 30 15:39:22 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/remote_filter.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=63 Fixed
	  indentation error in FilterRunner.

Tue Oct 30 14:25:25 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/startflax.py: Add --version option to display the version,
	  and --set-admin-password option which reads a new admin password
	  from stdin.  Still need to implement a method in cpserver.py to
	  actually store the new admin password.

Tue Oct 30 12:29:10 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates.py: Remove all XML comments from the generated HTML
	  pages.

Tue Oct 30 12:22:36 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates/collection_detail.html,src/templates/flax.html:
	  Tidy up some of the comments.

Tue Oct 30 12:07:20 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates/admin_banner.html,
	  src/templates/collection_detail.html,
	  src/templates/collections.html,src/templates/flax.html,
	  src/templates/index.html,src/templates/options.html,
	  src/templates/search.html,src/templates/user_banner.html: Remove
	  the $ID: keyword things.

Tue Oct 30 11:48:05 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates/flax.html: Correct a typo and set the character set
	  to UTF-8.  (Used to be set in the <?xml declaration, but we're
	  HTML 4.01 transitional now)

Tue Oct 30 10:53:09 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/templates/search.html,src/templates.py: Re:
	  http://code.google.com/p/flaxcode/issues/detail?id=59 The
	  previous fix had the unintended side effect of posts to advanced
	  search pages resulting in the simple search form being displayed.
	  Instead we redirect to the search form from the root url. Re:
	  http://code.google.com/p/flaxcode/issues/detail?id=60 Don't try
	  to render results if there are no collections.

Tue Oct 30 10:23:43 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/search.html:
	  http://code.google.com/p/flaxcode/issues/detail?id=59 Added an
	  explicit action for the search form to deal with issue 59.

Tue Oct 30 09:58:09 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/cpserver.py: Put the redirect back, so that users can refresh
	  on the options page to get the up-to-date settings, even after
	  they've changed an option.

Tue Oct 30 09:38:32 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* w32setup/HowToBuildFlaxStandaloneOnWindows.txt: I've put
	  appropriate tarballs into xappy/libs/, and SVN head doesn't
	  actually have all the bits xappy needs (it's on a branch, which
	  will be merged in a week or two), so point that out in this file.

Tue Oct 30 08:20:23 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/static/css/main.css,src/templates/admin_banner.html,
	  src/templates/search.html,src/templates/user_banner.html: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=54 Added links
	  for search/advanced search for user pages.

Tue Oct 30 08:18:10 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/startflax.py: Inadvertently ommitted from last checkin

Tue Oct 30 07:53:05 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/search.html: removed commented out label for query.

Tue Oct 30 07:15:42 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py,src/indexserver/remote_filter.py,
	  src/logclient.py: Made a process class to participate in
	  recieving log configuration notification changes. Used it for the
	  indexer process and remote filter processes. This means that
	  logging configuration changes now affect logging done by filters
	  running under remote filters.

Tue Oct 30 06:00:52 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py: Removed the sleep after updating option in the
	  options page. I'd already implemented a different fix for the
	  global options part of issue 55 - see the log entry for flax.py
	  revision 557.

Tue Oct 30 01:36:41 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/version.py: Add a version number file, to keep track better.

Tue Oct 30 01:18:21 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/cpserver.py: Add a sleep after changing the settings to allow
	  the changes to propagate before displaying the new settings, and
	  a redirect to stop reloads resending the POST.  Fixes issue #55
	  well enough for 1.0.

Mon Oct 29 16:40:07 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py: Remove flush() after every document -
	  we shouldn't need this, and it'll be terrible for performance.

Mon Oct 29 16:38:34 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/test/testfilespec.py: Brought into line with current code.

Mon Oct 29 16:30:33 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/w32com_ifilter.py: Use a threadlocal storage to
	  ensure that the pythoncom.CoInitialize() call is only performed
	  once for each thread, and use the newer
	  pythoncom.CoInitializeEx() form instead.

Mon Oct 29 16:29:38 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/remote_filter.py: Don't call the sub-filter twice
	  for every file! Also, pass through exception return values from
	  filters, so we can log them appropriately.

Mon Oct 29 15:35:26 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/remote_filter.py: Add missing :

Mon Oct 29 15:33:10 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/remote_filter.py,
	  src/indexserver/w32com_ifilter.py: If we get an error in a remote
	  filter, allow it to be returned across the pipe instead of the
	  iterator, and then raise it from inside the remote filter.  If we
	  can't get an appropriate ifilter in w32com_ifilter, return the
	  com exception object via the pipe.

Mon Oct 29 15:10:17 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py: Set the max mem use setting to 0.1 -
	  a low value, but should be high enough not to lose too much
	  performance, and should avoid risk of swapping.

Mon Oct 29 14:16:39 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/memutils.py: Remove this again - I've put it into xappy.

Mon Oct 29 13:30:36 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/flax.py:
	  http://code.google.com/p/flaxcode/issues/detail?id=55 Refreshed
	  the logging configuration immediately after setting it as a
	  partial workaround for issue 55. (This does mean that web server
	  process will set the current log settings twice.)

Mon Oct 29 13:21:20 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/memutils.py: Fixes.

Mon Oct 29 13:18:31 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/memutils.py: Routines to get available memory on a system.

Mon Oct 29 11:59:24 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/flax.html: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=57 Changed to
	  html 4.01 transitional from xhtml so that IE renders pages
	  properly.

Mon Oct 29 06:17:15 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/collection_detail.html: Added help text for the
	  name of the collection.

Mon Oct 29 06:13:55 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/collection_detail.html: Removed commmented out
	  script elements in the head.

Mon Oct 29 06:06:25 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/static/js/yui: Removed yui as we're not using it at the
	  moment. It can be reinstated if need be.

Mon Oct 29 06:05:43 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/collection_detail.html: Took out the reference to
	  serving files directly from Flax since we don't do this any more.

Sun Oct 28 13:09:57 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* utils/log2cl.py: Tidy whitespace.

Sun Oct 28 13:08:59 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/: Tidy up comments, whitespace and license headers.

Sun Oct 28 12:43:38 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py,src/indexserver/simple_text_filter.py:
	  Comments and whitespace.

Sun Oct 28 12:39:00 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/htmltotext_filter.py,src/indexserver/indexer.py,
	  src/indexserver/remote_filter.py,
	  src/indexserver/simple_text_filter.py,
	  src/indexserver/test_filters.py: Clean up licenses, whitespace
	  and some comments.

Sun Oct 28 12:16:05 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* ChangeLog,LICENSE,README,utils/install_dependencies.py,
	  utils/log2cl.py: Even more eol-style changes.

Sun Oct 28 12:13:09 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/cp.conf,src/epydoc.conf,src/flaxlog.conf,
	  src/static/css/main.css,src/templates/,src/test/testfilespec.py:
	  More eol-style=native properties.

Sun Oct 28 12:03:57 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/__init__.py,src/indexserver/htmltotext_filter.py,
	  src/indexserver/indexer.py,src/indexserver/remote_filter.py,
	  src/indexserver/simple_text_filter.py,
	  src/indexserver/test_filters.py,
	  src/indexserver/w32com_ifilter.py: Convert line endings to
	  native, and set the EOL style property to "native", which should
	  avoid further confusion with line endings.

Sun Oct 28 12:01:06 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/: Remove SVN keywords (ie, $id: entries) and set the EOL
	  style property to "native", which should avoid further confusion
	  with line endings.

Sun Oct 28 11:52:06 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/dbspec.py,src/flaxservice.py,src/uistrings.py,src/util.py:
	  Convert all line endings to unix style.

Sun Oct 28 11:50:01 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* LICENSE: Tidy up, and use the standard GPL boilerplate text.

Sun Oct 28 11:40:35 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/w32com_ifilter.py: Tidy up comments and
	  whitespace.  Add license header to this file, including the BSD
	  license text from the "Python for windows" extensions that this
	  file was partly derived from.

Sat Oct 27 10:57:58 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/test_filters.py: utility for testing (not used in
	  main code).

Sat Oct 27 08:46:20 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/collection_list.py,src/cpserver.py,src/search.py,
	  src/templates/advanced_search.html,src/templates/search.html,
	  src/templates.py: Populate (advanced)search form with values that
	  yielded result when showing the results.

Sat Oct 27 07:38:11 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=43 Switched to
	  using SyncManager rather than LocalManager to deal with issue 43.
	  I think the route cause of the problem is probably a bug in the
	  processing LocalManager code (on Windows at least). The cleanup
	  code for the localmanger tries to delete a temp file whilst
	  another process still has a handle on it. If you terminate
	  subprocesses manually then the problem goes away, but the whole
	  point of having daemonic processes is that the infrastructure is
	  supposed to tidy them up for you.

Sat Oct 27 07:03:58 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/startflax.py: (Inadvertently ommitted from last checkin)

Sat Oct 27 06:57:12 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: Refactored to split out the indexing
	  process from the controlling logic. Simplified the communication
	  with the indexer.

Sat Oct 27 06:55:01 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/filespec.py: Added a check for existence and a call to
	  realpath to avoid errors when walking to (dangling) symlinks.

Sat Oct 27 05:34:39 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/startflax.py: Called os.path.realpath on any paths we are
	  passed on the command line.

Sat Oct 27 00:42:33 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates.py: Tidy whitespace, and don't highlight query
	  terms for similarity queries (since the user didn't choose the
	  terms, and therefore probably isn't particularly interested in
	  whether the exact terms in the query are present.

Sat Oct 27 00:38:28 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/search.py: Tidy up whitespace, and add a checkatleast value
	  of 100, so that match estimates are always accurate if they're
	  under 100.

Fri Oct 26 20:03:58 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: In log message generation: replaced
	  dbpath with dbname, as that what's it's (now) called.

Fri Oct 26 17:39:13 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/search.py,src/templates.py: Formed an
	  appropriate query from the advanced search form inputs.
	  Refactored passing of arguments to search rendering, since
	  advanced is now implicit in the template. Added extra data to the
	  key to the template cache to account for the fact that different
	  urls can be generated from the same file name, so we need to
	  differentiate the cached templates on this basis.

Fri Oct 26 17:36:34 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/util.py: Tidy up documentation comments for AsyncFunc.

Fri Oct 26 16:23:27 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/collection_list.py,src/doc_collection.py: Revert r492, which
	  removed reference to flaxpaths from inside doc_collection, since
	  this now works even in the subprocess.

Fri Oct 26 16:19:00 UTC 2007  charliejuggler

	* w32setup,w32setup/HowToBuildFlaxStandaloneOnWindows.txt,
	  w32setup/flax.iss,w32setup/gpl.txt,w32setup/makew32svc.bat,
	  w32setup/setup_svc.py: First pass of build files for Flax
	  standalone on Windows

Fri Oct 26 16:18:43 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py: Put flaxpaths into object which gets
	  pickled and passed across to subprocess on windows.

Fri Oct 26 15:59:04 UTC 2007  charliejuggler

	* src/flaxservice.py: Added some extra comments about how to run in
	  a non-frozen environment

Fri Oct 26 15:54:28 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flaxservice.py: Remove an old FIXME - I did the checking it
	  was to remind me about.

Fri Oct 26 15:51:28 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/collection_list.py,src/cpserver.py,src/search.py: Removed
	  format handling code in search form processing since the form no
	  longer has elements for formats.

Fri Oct 26 15:49:56 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: In render_search_result: corrected subnode
	  references when filling in "no search results" stuff.

Fri Oct 26 15:42:52 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/advanced_search.html,src/templates.py: Removed
	  formats from advanced search form.

Fri Oct 26 15:34:31 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flax_service.py: Remove old file - this was renamed to
	  flaxservice.py, but got left in the repo somehow.

Fri Oct 26 15:22:52 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=48 In
	  TemplateManager.make_template: added AttributeError to the catch
	  clause when setting the banner id to cope with pages that don't
	  have a banner.

Fri Oct 26 15:10:50 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates.py: Display the url to the document instead of a
	  title if no title is found - unless there is also no mapping, in
	  which case we display the filename.

Fri Oct 26 14:47:28 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/doc_collection.py: Fix documentation comment, and change \ in
	  file paths to / when making a URL, to work on windows.  Return ""
	  instead of "/" if there is no mapping - as described by the
	  documentation comment, and because it's easier to test for to
	  provide alternative handling.

Fri Oct 26 14:25:53 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flaxlog.conf: Change default log configuration to be NOTSET
	  for all but the default logger, and the default logger to be
	  WARNING.  At least this logging configuration is easy to describe
	  in documentation!

Fri Oct 26 14:20:26 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flaxlog.conf: Change default log configuration to use
	  FlaxRotatingFileHandler

Fri Oct 26 14:19:42 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flaxloghandlers.py,src/logclient.py: Add a custom log
	  handler, to log to the flax log output directory.  Needs to be
	  added into the logger namespace to be used, so do that in the
	  logclient.py module setup.

Fri Oct 26 13:23:57 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/startflax.py: Setup the logging options before reading the
	  main configuration, so that problems with it (like an old version
	  number) can be reported.

Fri Oct 26 12:02:24 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/cpserver.py: Correct a comment typo and remove an unnecessary
	  test.

Fri Oct 26 08:57:58 UTC 2007  charliejuggler

	* src/flaxservice.py: make sure stdout and stderr end up in logs/
	  subfolder

Fri Oct 26 07:25:18 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/w32com_ifilter.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=35 Ensured
	  that the data returned by the filter is unicode. Note that this
	  change affect things at indexing time, so collections must be re-
	  indexed to notice the effect of this change.

Fri Oct 26 05:16:22 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/doc_collection.py: In search_conn. If we get a xapian
	  DatabaseOpeningError when trying to make a search connection then
	  remake the database. To deal with the possibility that the
	  database has been moved/deleted.

Thu Oct 25 17:44:29 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/flax.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=46 Added .htm
	  to formats

Thu Oct 25 16:05:00 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/static/css/main.css,src/templates/,
	  src/templates.py: Removed the (near-)duplicated search templates
	  and just used one (fixes:
	  http://code.google.com/p/flaxcode/issues/detail?id=32) Moved the
	  rendering of the admin navigation to css, and hence removed the
	  dependency on cherrypy in templates.py Removed the onload from
	  the main template and refactored templates that need a call to
	  include one. (Fixes
	  http://code.google.com/p/flaxcode/issues/detail?id=30)

Thu Oct 25 12:33:56 UTC 2007  charliejuggler

	* src/flax_w32.py: fix Registry path

Thu Oct 25 12:02:52 UTC 2007  charliejuggler

	* src/flaxservice.py: Rename for easier typing of eventual
	  executable!

Thu Oct 25 12:02:02 UTC 2007  charliejuggler

	* src/flax_w32.py: Remove executable path as no longer needed

Thu Oct 25 12:01:30 UTC 2007  charliejuggler

	* src/flax_service.py: Change the way we set sys.executable to work
	  better in a Py2exe Service

Thu Oct 25 11:59:04 UTC 2007  charliejuggler

	* src/startflax.py: Allow src_dir to be set (on Windows we must be
	  able to set it otherwise /static won't work)

Thu Oct 25 02:00:45 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/flax_w32.py,src/flaxpaths.py,src/startflax.py: Reinstated
	  src_dir so that we can have a seperate path for things that
	  naturally live in svn. Incorporated the startup logic from
	  flax_w32 into the main startup code in startflax.

Thu Oct 25 01:37:18 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/flax_w32.py: standardised line endings

Thu Oct 25 01:36:00 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/start.py,src/startflax.py: rename to startflax

Thu Oct 25 01:26:46 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/collection_list.py,src/cpserver.py,src/search.py: Made a
	  start on the advanced search form functionality. It doesn't yet
	  do the right thing...

Wed Oct 24 15:48:10 UTC 2007  charliejuggler

	* src/flax_service.py: Removed Registry stuff to a different
	  module; tidied debug prints to use LogInfoMsg; tied stdout and
	  stderr handling; added some more EventLog messages (temporarily)

Wed Oct 24 15:46:27 UTC 2007  charliejuggler

	* src/flax_w32.py: New class encapsulating data read from Registry,
	  and a new main() loop for when running as a Windows command line
	  application

Wed Oct 24 15:41:36 UTC 2007  charliejuggler

	* src/flaxpaths.py: Removed src_dir as no longer needed in Win32
	  startup

Wed Oct 24 07:31:34 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/collection_list.py,src/doc_collection.py,src/flax.py: Passed
	  the database directory to collections on creation, because the
	  pickled copy of a collection in the indexing process needs to
	  know the path to its database, which doesn't work correctly by
	  attempting to read the flaxpaths.paths object - the one in the
	  indexing process doesn't have the correct values. This is a
	  functional change in that the path to a collections database is
	  fixed at the creation time of the collection. We could arrange to
	  syncronise the global state between the processes if need be.

Wed Oct 24 07:26:30 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: In IndexServer.__init__ Use
	  processing.Lock rather than threading.Lock (see comments in the
	  file for reason).

Tue Oct 23 05:18:56 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/flaxpaths.py,src/start.py: Ensured that the path options are
	  used correctly when running from the command line.

Mon Oct 22 14:17:14 UTC 2007  charliejuggler

	* src/start.py: Put freezeSupport() back in - we need it for Py2exe
	  (and it's in the Service anyway, and shouldn't have any ill
	  effects)

Mon Oct 22 14:00:00 UTC 2007  charliejuggler

	* src/flax_service.py: Set src_dir from Registry so static\ paths
	  etc are correct

Mon Oct 22 13:59:18 UTC 2007  charliejuggler

	* src/flaxpaths.py: Make it possible to set src_dir (we need this
	  when running frozen under Py2exe)

Mon Oct 22 11:28:09 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/indexserver/indexer.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=14 Added a
	  stop_indexing method to IndexServer and used to stop indexing
	  after a collection is updated. Added a lock to ensure that
	  changes to .stop_sv and and currently_indexing happen togther. In
	  indexer.do_indexing added a flush for the indexer connection in
	  the main loop. This was because a) Ram usage can get large, and
	  b) holding/stopping indexing can seem very unresponsive if there
	  is still a lot of work outstanding when the stop flag is set.

Mon Oct 22 10:22:09 UTC 2007  charliejuggler

	* src/indexserver/indexer.py,src/start.py: Must set logconfpath for
	  the index server at creation, because the indexserver runs in a
	  different process and won't see the same Flaxpaths as we
	  originally created

Mon Oct 22 08:48:46 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py: Took out the FIXME in Collections.new and
	  created http://code.google.com/p/flaxcode/issues/detail?id=39 to
	  address this and similar issues.

Sun Oct 21 21:02:15 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/templates/collections.html,src/templates.py:
	  Implemented collection deletion. Possible outstanding related
	  issues: Maybe a confimation prompt? Also delete the underlying
	  xapian database?

Sun Oct 21 20:46:58 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/collections.html: Brought the descriptive text into
	  line with the table.

Sun Oct 21 17:50:44 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py:
	  http://code.google.com/p/flaxcode/issues/detail?id=14 Set a
	  collection as due for indexing after it's been update. This
	  change doesn't stop a currently indexing collection as suggested
	  in comment 3. I'm not sure what's needed to acheive this atm.
	  There's no queue of actions for each collection, so we'd need to
	  hold it until it stops, then unhold it. But there are either
	  synchronisation or blocking issues.

Sun Oct 21 14:42:57 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/doc_collection.py,src/flax.py,
	  src/indexserver/indexer.py,src/scheduler.py,src/start.py,
	  src/templates/collection_detail.html,
	  src/templates/collections.html,src/templates.py,src/util.py:
	  Refactored the way that indexing is controlled. All the logic
	  about what gets indexed and when is in the main process. The
	  indexing process just responds to requests to index things. The
	  shared state for reporting on the indexing progress and for
	  prematurely stopping the indexer is all done via shared memory
	  now. Cached information about the last indexing of document
	  collections in the collection object itself, so that something
	  useful can be shown after a restart. Updated the UI to display
	  such information. Fixed a problem with log configuration
	  propogation to the indexing process.

Fri Oct 19 14:43:22 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/img/flax.125trans.png,
	  src/static/img/flax.250trans.png: Changed logo to include Site
	  Search

Fri Oct 19 14:34:11 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates.py: Changed for issue 34

Fri Oct 19 14:32:45 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/advanced_search.html,
	  src/templates/search_result_admin.html: Reverted, as it makes
	  less sense now

Fri Oct 19 13:11:25 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/flax.py: Fixed issue 33

Fri Oct 19 12:51:43 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css: changed collection table head to pale
	  blue

Fri Oct 19 08:44:43 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/util.py: Added AsyncFunc

Fri Oct 19 05:21:01 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/util.py: Removed IO as it is not used any more.

Fri Oct 19 00:48:43 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flax_service.py: Add the processing.freezeSupport() call back
	  - it'll be needed if we ever want to build with py2exe, we're
	  likely to forget it, and it doesn't seem to cause problems on
	  machines I have access to.  Also, tidy up some code comments.

Thu Oct 18 15:43:46 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/remote_filter.py: Correct trivial typos.

Thu Oct 18 15:16:10 UTC 2007  charliejuggler

	* src/flax_service.py: Add another Event Log message for after
	  everything has shut down successfully

Thu Oct 18 15:08:31 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flax_service.py,src/start.py: Add join() method back (though
	  don't use a separate thread behind it).  Also add a timeout to
	  join() so that the SvcDoRun() method can reassure windows that
	  it's still doing something while shutting down.

Thu Oct 18 14:53:51 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flax_service.py: Tidy up lots of code comments, particularly
	  giving more detail for FIXMEs. Add Python.exe to python paths
	  read from the registry if the path points to a directory - this
	  allows either a directory or a full path to be specified in the
	  registry (we should use a full path in the installer, probably).
	  call sys.exitfunc() at the end of SvcDoRun, so it only happens
	  after _flax_main.start() has exited, rather than calling it in
	  SvcStop(), where it was called immediately after the signal to
	  stop was called.

Wed Oct 17 21:01:26 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/flax_service.py,src/start.py: Various changes
	  to get things working more smoothly when running as a windows
	  service. - Took out some exception catching, this means that
	  unhandled exceptions will end up in the system event log where we
	  can see them. - set sys.argv[0] to '' when we're running as a
	  service to get round an exception that's raised in processing. I
	  don't fully understand what's going on here (the error is new
	  with 0.35 of processing - I'm not sure if it's really a bug in
	  that module, or we're doing something bad that's causing the
	  exception). - Made an explicit latish call to sys.exitfuncs. I'm
	  not sure why we need to do this, but since we're not running
	  under the standard python.exe I guess that for some reason it
	  doesn't get called automatically. This is necessary to ensure
	  that anything registered with the atexit module to run on
	  termination actually get called on termination. - remove call to
	  processing.freezeSupport. It doesn't seem to do anything useful
	  at the moment - we can put it back if there's a reason to. -
	  Simplified by getting rid of the separate thread to run cherrypy
	  and used the facilities provided by cp to run start without
	  blocking, then used an explicit call to stop cp.

Wed Oct 17 14:37:13 UTC 2007  charliejuggler

	* src/flax_service.py: some extra debug

Wed Oct 17 11:20:08 UTC 2007  charliejuggler

	* src/flax_service.py: remove subprocess which was used for
	  debugging

Wed Oct 17 11:14:58 UTC 2007  charliejuggler

	* src/flax_service.py: Make sure sys.executable is set correctly,
	  and some service logging tidyups

Wed Oct 17 10:05:47 UTC 2007  charliejuggler

	* src/flax_service.py: make sure Windows EventLog knows where our
	  messages are coming from

Tue Oct 16 10:19:23 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* utils/install_dependencies.py: Updated processing module to
	  version 0.35

Tue Oct 16 09:12:14 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates.py: Display collections in alphabetical order

Mon Oct 15 15:14:39 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/cpserver.py,src/flaxpaths.py,src/start.py: Fix finding of the
	  template directory (was using hardcoded path).

Mon Oct 15 15:08:15 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/templates/collection_detail.html:
	  More tidying up of collection details

Mon Oct 15 14:55:53 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/templates/collection_detail.html: simple readability tweak to
	  collection details

Mon Oct 15 14:17:26 UTC 2007  charliejuggler

	* src/flax_service.py: truncate stderr and stdout log files

Mon Oct 15 14:12:57 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/collection_list.py,src/dbspec.py,src/doc_collection.py,
	  src/flax.py,src/indexserver/indexer.py: Tidy up the handling of
	  paths for databases - the database path configured by flaxpaths
	  is now respected.

Mon Oct 15 14:01:58 UTC 2007  charliejuggler

	* src/flax_service.py: Fixed to use new paths interface in start.py

Mon Oct 15 13:39:43 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/templates/collections.html,
	  src/templates.py: Tarted up collections list

Mon Oct 15 13:16:51 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/start.py: Fix my broken commit.

Mon Oct 15 13:04:33 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/cp.conf,src/flax.py,src/indexserver/indexer.py,
	  src/logclient.py,src/start.py: Rework the path handling, to use
	  flaxpaths.  Some items still need reworking.

Mon Oct 15 12:39:47 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flaxpaths.py: Further updates

Mon Oct 15 12:37:38 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/search.py,src/templates.py: If there are no collections, and
	  a search is performed, display a message saying that there are no
	  collections, rather than displaying a traceback.

Mon Oct 15 12:07:20 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flaxpaths.py: Centralised handling for file paths.

Mon Oct 15 11:59:39 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flax_service.py: Some tidyups.

Mon Oct 15 11:40:23 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/cpserver.py,src/templates/options.html,src/templates.py:
	  Remove option to set the flax directory at run-time - semantics
	  are too confusing to specify (eg, should existing databases be
	  moved, etc).  Instead, we'll allow it to be specified in the
	  installer, or as a command line parameter when starting the
	  server.

Mon Oct 15 11:34:29 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/cpserver.py,src/indexserver/indexer.py,src/start.py: Revert
	  commits 441 and 443 - I have a better fix.

Mon Oct 15 11:09:52 UTC 2007  charliejuggler

	* src/cpserver.py,src/indexserver/indexer.py: Use a passed in path

Mon Oct 15 11:05:33 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py: Tiny typo in comment.

Mon Oct 15 11:05:01 UTC 2007  charliejuggler

	* src/start.py: Attempt to pass the correct paths to other modules
	  at startup

Mon Oct 15 11:04:27 UTC 2007  charliejuggler

	* src/flax_service.py: Use the default installation folder if we
	  can't read the Registry; use regutils to try and find the
	  interpreter; attempt to pass the main path to various other
	  modules

Mon Oct 15 10:45:35 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/templates/admin_banner.html,
	  src/templates.py: Generate admin tabs from a list

Mon Oct 15 10:22:51 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/doc_collection.py,src/flax.py,
	  src/indexserver/indexer.py,src/search.py,
	  src/templates/collections.html,src/templates.py:
	  http://code.google.com/p/flaxcode/issues/detail?id=7 Made
	  infrastructure for discovering status of indexer and used the
	  results in the collection list page. I'm not exactly sure what
	  statistics are useful or interesting, but at least now it should
	  be straigtforward to add things to the dictionaries used for this
	  information. We use a search connection for collections in a few
	  places so I've cached one in the DocCollection object and
	  (ensured that we don't try to pickle it).

Mon Oct 15 10:08:44 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/cpserver.py,src/templates/admin_banner.html: removed admin
	  home

Mon Oct 15 01:08:55 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py: Tidy up the imports, change some of
	  the log.info messages to log.debug (we only need one message per
	  file at info level, I think) and pass the logconf path to the
	  indexing loop rather than using the hardcoded default.  (The path
	  passed is the hardcoded default, but that can be fixed easily.)

Mon Oct 15 01:01:50 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/cpserver.py,src/start.py: Pass the path to the CherryPy
	  configuration file to cpserver.start_web_server(), rather than
	  hard-coding it in cpserver.  Is currently hardcoded in start.py,
	  but I'll fix that shortly...

Mon Oct 15 00:57:34 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/cpserver.py: Display a different message if no collection
	  name is specified when making a new collection to if the
	  collection name is already in use. Both of these cases need to be
	  tidied up (currently, they just display a traceback with the
	  message at the end), but at least the distint causes are now
	  clear.

Mon Oct 15 00:54:49 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* cpserver.py,src/cpserver.py,src/templates.py,templates.py:
	  Introduce a Renderer class, and move all the *_render functions
	  from the end of the module into this class.  Gets rid of the need
	  to have a single global TemplateManager object, which may be
	  handy later, and adds a more natural location for specifying the
	  path to the template directory (ie, in the constructor of the
	  Renderer class).  Also, use the new uistrings in a few places.
	  Create a templates.Renderer when starting the web server, and use
	  this instead of the old global functions to render the templates.

Mon Oct 15 00:46:26 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/cpserver.py: Remove incorrect _ from
	  self._collections._formats

Mon Oct 15 00:39:02 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/uistrings.py: Add some uistring messages for spelling
	  correction.

Mon Oct 15 00:26:38 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/search.py: Check if the spell corrected query actually
	  matches anything - if it doesn't, don't suggest it, or use it
	  automatically.

Sun Oct 14 23:54:38 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/logclient.py: Tidy whitespace, and rename "filename" member
	  to "filepath", since it needs to be a full path (if we want to be
	  independent of current working directory, as we do when running
	  as a windows service).

Sun Oct 14 23:17:42 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/collection_list.py: Add missing quotes around bareword
	  "formats".

Sun Oct 14 17:19:47 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates.py: Remove "html_dir" parameter to TemplateManager
	  constructor, and the write_html_file() method - it wasn't being
	  used anywhere.  Cleanup whitespace and formatting in a few
	  places.

Sun Oct 14 15:46:26 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: removed a debugging print.

Sun Oct 14 15:45:15 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/doc_collection.py: removed the call of normpath on paths -
	  inadvertently included in last check in.

Sun Oct 14 14:14:16 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=28 string-
	  escape encoded the paths for the embedded javascript.

Sun Oct 14 13:51:53 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: removed debugging print.

Sun Oct 14 13:50:39 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/collection_list.py,src/cpserver.py,src/doc_collection.py,
	  src/flax.py,src/search.py,src/templates/search_result.html,
	  src/templates/search_result_admin.html,src/templates.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=20 Used the
	  xapian spell correction facility to find spell corrections.
	  Automatically use this when oringinal query returns no results.
	  Show these in the UI. Refactored search results to package up
	  related information in an object.

Sun Oct 14 13:46:59 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: split long line

Sat Oct 13 10:40:22 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py: Remove extraneous whitespace.

Sat Oct 13 10:38:37 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py: Add a name for the index server
	  process, for better debugging output.

Sat Oct 13 10:21:25 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flax_service.py: Add a FIXME note.

Sat Oct 13 10:20:27 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/start.py: Clean up startup when non-blocking.

Sat Oct 13 00:53:21 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flax_service.py: Oops.  Avoid infinite loop.

Sat Oct 13 00:52:05 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flax_service.py: Attempt to set sys.executable to a valid
	  python interpreter (and give an error if we can't).  This is
	  absolutely needed for processing to work on windows.

Fri Oct 12 23:32:44 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/cpserver.py,src/start.py: Fix blatant bugs in stopping code.

Fri Oct 12 23:25:24 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/start.py: Another stupid typo.

Fri Oct 12 23:22:57 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/start.py: Add import of threading module.

Fri Oct 12 23:21:53 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flax_service.py: Fix typo.

Fri Oct 12 23:19:27 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flax_service.py: Various fixes, and make the service output
	  error information if an uncaught exception is thrown.

Fri Oct 12 21:31:00 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flax_service.py: Add import of processing when running from
	  command line.

Fri Oct 12 21:25:30 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/persist.py: Bah - typo.

Fri Oct 12 21:24:29 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/persist.py: Cope with more broken flax.flx files.

Fri Oct 12 21:19:49 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/util.py: Tidy up setting of paths.

Fri Oct 12 21:18:21 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flax_service.py: Add work-around to prevent signal causing an
	  error when run as a service.

Fri Oct 12 21:06:30 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flax_service.py: Make flax_service use start.py to handle all
	  the stuff which needs to be started or stopped.

Fri Oct 12 16:07:47 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/start.py: Add infrastructure so that all the flax services
	  can be started with a single call, and signalled to stop, and
	  then stopped. (We may need to do more work to get the stop to
	  work cleanly, but the interface is now one which should be usable
	  from the win32 service startup module)

Fri Oct 12 15:18:00 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates/flax.html: Split startup code out of cpserver.  You
	  now need to run "python start.py" instead of "python
	  cpserver.py".

Fri Oct 12 15:04:08 UTC 2007  charliejuggler

	* src/flax_service.py: prototype service wrapper

Fri Oct 12 14:09:15 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/cp.conf,src/static/img/favicon.ico: added custom favicon.ico

Fri Oct 12 13:41:04 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/templates/search_result.html,
	  src/templates/search_result_admin.html: Moved and restyled
	  similar link

Fri Oct 12 13:19:52 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/templates/search_admin.html,
	  src/templates/search_result_admin.html,src/templates.py: neater
	  admin search layout

Fri Oct 12 11:38:22 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/cpserver.py,src/start.py: Split startup code out of cpserver,
	  and put it in new file "start.py"

Fri Oct 12 11:37:21 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* README: Update instructions on starting flax.

Fri Oct 12 11:35:34 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/__init__.py,src/indexserver/indexer.py: Make
	  indexserver into a module, and move setuppaths before import of
	  processing.

Fri Oct 12 11:34:53 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/filespec.py: Add some debugging logging.

Fri Oct 12 11:23:06 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/doc_collection.py: Removed the ability to
	  search document source files via Flax as it might be a bit of a
	  security hole. Also removed the code to make urls pointing at
	  this when no mapping is supplied for a path.

Fri Oct 12 10:52:01 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/dbspec.py,src/flax.py,src/indexserver/indexer.py: Rework
	  dbspec.py to separate out the configuration of internal fields
	  from ones which filters can return; makes a single source file
	  need to be modified to add configuration for a new internal
	  filter.  Increase the version number in flax.flx, since databases
	  will need to be re-created for the new configuration.

Fri Oct 12 10:49:27 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates.py: Encode title as utf-8.

Fri Oct 12 10:18:06 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/htmltotext_filter.py: Remove debug print.

Fri Oct 12 09:54:17 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/static/js/mapping.js,src/templates/collection_detail.html,
	  src/templates.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=11 Moved to
	  javascript for making the path/mapping inputs and added a button
	  to create more pairs.

Fri Oct 12 06:11:44 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/doc_collection.py,src/templates/collection_detail.html,
	  src/templates.py:
	  http://code.google.com/p/flaxcode/issues/detail?id=11 Made a
	  start on mapping for paths, the mapping values are not yet used
	  and we need to inlude some javascript to push extra input boxes
	  into the page. FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=21 Mappings
	  are now used to generate the urls for files, and title are used
	  if available, to the work for issue 21 is done. (Probably some
	  cosmetic work on the "search for similar" link is desirable.)
	  http://code.google.com/p/flaxcode/issues/detail?id=11 Added code
	  to generate urls from doc ids based on the mappings. Also fixed a
	  problem with adding lots of blank mapping enties on round-
	  tripping. This "works" now, but still could do with some
	  javascript to add extra path/mapping input boxes without round-
	  tripping.

Fri Oct 12 01:06:37 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/dbspec.py,src/flax.py: Tidy up code and comments. Hardcode
	  the list of log levels, rather than getting them from the logger
	  module.  To get them from the logger module, we needed to
	  hardcode a set of values, anyway, and we'll break elsewhere if
	  the names change (not least, the configuration format will
	  change).  So I prefer to be explicit about the hard-coding.

Fri Oct 12 00:41:42 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates/options.html: Update descriptions of logging
	  levels.

Fri Oct 12 00:40:22 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates.py: Use uistrings instead of "capitalize()" to get
	  the displayable form of the logging level.

Fri Oct 12 00:38:21 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py: Tidy up some code and comments.

Fri Oct 12 00:09:25 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/collection_list.py: Tidy up documentation comments.

Fri Oct 12 00:03:41 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/uistrings.py: Add new file, which will hold any strings used
	  in the user interface in a single location.  Will make
	  translations of the UI easier in future.

Thu Oct 11 17:11:36 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/collection_list.py,src/cpserver.py,src/doc_collection.py,
	  src/flax.py,src/search.py,src/templates/collection_detail.html,
	  src/templates.py:
	  http://code.google.com/p/flaxcode/issues/detail?id=11 Made a
	  start on mapping for paths, the mapping values are not yet used
	  and we need to inlude some javascript to push extra input boxes
	  into the page.
	  http://code.google.com/p/flaxcode/issues/detail?id=21 Refactored
	  the "search for similar" stuff so that (inter alia) the
	  pagination works for the results.

Thu Oct 11 17:08:24 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/util.py: added listify

Thu Oct 11 13:16:47 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flax.py: Remove the variants of the english stemmer - they're
	  really no use to users.

Thu Oct 11 13:06:31 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/collection_list.py,src/flax.py,src/flax_collections.py:
	  Rename flax_collections.py to collection_list.py to go with the
	  internal class name.

Thu Oct 11 12:34:57 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/flax.py,src/flax_collections.py: Rename FlaxCollections to
	  CollectionList - the random "Flax" prefix was bugging me.

Thu Oct 11 09:08:03 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: Remove diagnostic prints.

Thu Oct 11 08:16:34 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/flax.py,src/persist.py,src/search.py,
	  src/templates/search_result.html,src/templates.py: Implented a
	  simple version system for the pickled data. This means old
	  flax.flx file will (this time) cause an error, but thereafter a
	  warning about incompatible versions will be emmitted and data
	  reset to he defaults. Moved the log configuration further down
	  the startup code so that the root logger is configured before we
	  issue any warnings. Changes for "similar document search" as per
	  http://code.google.com/p/flaxcode/issues/detail?id=21 Added a
	  link for similar searches, not quite done yet as we need to get
	  back a string from the query (i.e. implement search.unparse()
	  properly)

Thu Oct 11 05:48:09 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: corrected missing comma in
	  _process_file

Thu Oct 11 04:58:50 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py: removed a diagnostic print.

Thu Oct 11 04:57:10 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/dbspec.py: imported types as it's used.

Wed Oct 10 23:04:12 BST 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/templates/flax.html: Change character encoding to utf-8: this
	  is the character set that output from xappy will be in, so we
	  might as well use it for display.

Wed Oct 10 16:28:11 BST 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/doc_collection.py: Move future import before __docformat__.

Wed Oct 10 16:09:15 BST 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/cpserver.py,src/filespec.py,src/dbspec.py,src/doc_collection.py:
	  Add standard license and copyright header, and tidy up some code
	  comments and whitespace.  Remove "$ID:" markers.  Tidy up code to
	  follow PEP8 better (remove whitespace around = when specifying
	  default arguments to functions, and change multiline
	  documentation comments to start with """Single line of text...
	  and to end with a blank line before the closing """).
	  Change DBSpec.update() to accept any sequence or iterator for its
	  stopwords argument.

Wed Oct 10 16:07:42 BST 2007  Richard Boulton <richard@lemurconsulting.com>

	* utils/install_dependencies.py,utils/log2cl.py: Tidy up a couple
	  of comments.

Wed Oct 10 10:36:51 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/collection_detail.html,src/templates.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=13 Made the UI
	  for the oldest property a dropdown.

Wed Oct 10 08:41:12 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/flax.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=12 Added rtf
	  to list of formats.

Wed Oct 10 08:38:08 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/filespec.py,src/templates/collection_detail.html,
	  src/templates/search.html,src/templates.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=13 Removed all
	  the date related stuff from filespecs except for the "oldest"
	  property. FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=9 Added a
	  definition list to search forms giving collection names and
	  descriptions.

Wed Oct 10 08:06:56 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/flaxlog.conf: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=26 Added
	  searching to the the keys attribute of the loggers section.

Tue Oct 09 17:35:16 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* libs/htmltotext/ChangeLog,libs/htmltotext/src/pyhtmltotext.cc:
	  src/pyhtmltotext.cc: Don't use a zero size array - MSVC doesn't
	  like it.

Tue Oct 09 14:08:00 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/templates/collection_detail.html,
	  src/templates/collections.html,src/templates.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=10 Removed the
	  form on the collection listing page, added a new link for
	  creating a collection. Changed the detail form to cope with
	  updating or creation.

Tue Oct 09 10:10:49 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/dbspec.py,src/indexserver/indexer.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=18 Added a
	  "basename" field to hold the base filename, and arranged for the
	  indexer to add content to this. Also added a managed dictionary
	  to communicate the state of indexing between the indexer and web
	  server as per
	  http://code.google.com/p/flaxcode/issues/detail?id=7 ( not yet
	  complete).

Tue Oct 09 09:51:52 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/flax.py,src/templates/options.html,src/templates.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=23 Got rid of
	  the separate database directory and hard coded the database
	  directory to be a "dbs" subdir of whatever the flax directory is.

Tue Oct 09 09:43:16 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/flax.py,src/templates/options.html,src/templates.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=24 Got rid of
	  the sub-loggers for individual filters from the UI, changed radio
	  buttons to checkboxes.

Tue Oct 09 09:40:20 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py: whitespace tidying.

Tue Oct 09 09:23:41 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py: removed the code to process filter settings
	  since the form no longer contains such elements.

Tue Oct 09 04:54:06 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=1 Checked for
	  existence of collection database. If it's not there log an error
	  and return. Ensure that we only try to close the db connection if
	  it's already been opened.

Tue Oct 09 04:39:43 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/w32com_ifilter.py: Removed duplicate import.
	  Corrected the name of the logger so that it properly fits within
	  logging heirarchy. Whitespace tidying. Put parent directory on
	  sys.path.

Tue Oct 09 04:17:23 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py,src/indexserver/w32com_ifilter.py:
	  Created an filter to run ifilters in a subprocess and used it in
	  favour of the in process version.

Tue Oct 09 04:15:41 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/remote_filter.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=5 Changed the
	  default timeout for the subprocess to 30.

Mon Oct 08 19:13:42 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/options.html,src/templates.py: FIXES:
	  http://code.google.com/p/flaxcode/issues/detail?id=3 Removed the
	  UI options to modify filter settings. Note that persistent data
	  with other filters set now have no user accessible way of
	  changing the filters, so flax.flx probably needs to be deleted.

Mon Oct 08 08:58:52 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* utils/install_dependencies.py: Add processing to set of packages
	  installed automatically.

Mon Oct 08 08:44:51 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* utils/install_dependencies.py: Make the temporary directory tree
	  writable before deleting it.

Mon Oct 08 08:17:46 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* utils/install_dependencies.py: Actually, just pass through all of
	  the environment variables, only modifying those which we want to.

Mon Oct 08 08:13:43 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* utils/install_dependencies.py: Pass through the PATH environment
	  variable.

Mon Oct 08 07:37:26 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/filterrunner.py,src/indexserver/remote_filter.py:
	  changed remote filter to use processing module and added a
	  timeout/kill mechanism. deleted filterrunner.py and brought the
	  server end into remote_filter.

Sun Oct 07 19:50:05 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* utils/install_dependencies.py: Move "communicate" call to after
	  wait, when running subprocess. Helps on windows.

Sun Oct 07 16:45:49 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: commented out htmltotext filter stuff
	  pending getting it going on windows. Downcase filename extension
	  prior to looking up filter.

Sun Oct 07 15:06:33 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* README: Added notes about processing dependency. Finished a
	  couple of incomplete sentences. Typos.

Sun Oct 07 12:29:41 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* README: updated to reflect current sources.

Sun Oct 07 12:21:30 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/doc_collection.py,src/flax.py,
	  src/flaxlog.conf,src/indexserver/indexer.py,
	  src/indexserver/indexserver.py,src/logclient.py,
	  src/logconfserver,src/scheduler.py,src/util.py: Removed all the
	  depenencies on Pyro (but added a dependency on processing).
	  Brought all the functionality from the logconf server inside the
	  web server. Used processing module for separate processes (only
	  the indexserver at the moment). Arranged for the web server to
	  start the indexserver process.

Sun Oct 07 11:16:49 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/logconfserver/filewatch.py,src/util.py: moved implementation
	  of FileWatcher to util

Sun Oct 07 07:52:29 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/flax.py: tidying whitespace.

Sun Oct 07 07:35:57 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: Factored log_settings call out of the loops in
	  options template.

Sat Oct 06 16:32:29 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/htmltotext_filter.py,src/indexserver/indexer.py:
	  Add a very basic HTML filter.

Sat Oct 06 14:31:01 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* README: Update note on dependencies, and suggest using
	  utils/install_dependencies.py to get them.

Sat Oct 06 12:10:43 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* utils/install_dependencies.py: Add rules to install xappy to
	  localinst.

Sat Oct 06 09:26:20 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* README: Add a note on using utils/install_dependencies.py

Sat Oct 06 09:22:06 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/util.py,utils/install_dependencies.py: Add support for
	  installing libs stored under the "libs" directory, and add a line
	  to install htmltotext in this way.  Put locally installed libs in
	  localinst, and change the path correspondingly.

Sat Oct 06 08:57:38 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* libs/htmltotext/ChangeLog,libs/htmltotext/setup.py: setup.py:
	  Make download URL point directly to the package to download.

Sat Oct 06 08:55:17 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* libs/htmltotext/ChangeLog,libs/htmltotext/MANIFEST.in,
	  libs/htmltotext/eggsetup.py,libs/htmltotext/setup.py,
	  libs/htmltotext/src/pyhtmltotext.cc,libs/htmltotext/test/test.py:
	  src/pyhtmltotext.cc,test/test.py: Fix a bug where we were
	  ignoring the content of the document, and only reporting the
	  content of meta-description fields.  Rename the "sample" output
	  field to "description", and add a "content" output field.
	  setup.py: Update for release 0.6 MANIFEST.in,ChangeLog: Add a
	  ChangeLog to keep track of changes.

Fri Oct 05 17:57:35 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* libs/htmltotext,libs/htmltotext/MANIFEST.in,
	  libs/htmltotext/README,libs/htmltotext/eggsetup.py,
	  libs/htmltotext/setup.py,libs/htmltotext/src/config.h,
	  libs/htmltotext/test,libs/htmltotext/test/__init__.py: Finish
	  packaging for 0.5

Fri Oct 05 15:02:20 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* libs/htmlparser,libs/htmltotext,libs/htmltotext/src,
	  libs/htmltotext/src/config.h,libs/htmltotext/src/pyhtmltotext.cc:
	  Rename htmlparser module.

Fri Oct 05 15:01:27 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* libs/htmlparser,libs/htmlparser/MANIFEST.in,
	  libs/htmlparser/setup.py,libs/htmlparser/src/config.h,
	  libs/htmlparser/src/pyhtmltotext.cc,libs/htmlparser/test,
	  libs/htmlparser/test/test.py: Basic python module around html
	  parser for extracting text.

Fri Oct 05 14:36:50 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* libs/htmlparser/src/myhtmlparse.cc,
	  libs/htmlparser/src/myhtmlparse.h: Add a method allowing the
	  character set to be fixed (which will cause any character set
	  information in the document to be ignored).

Fri Oct 05 09:52:54 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/remote_filter.py,src/util.py: Removed -u on
	  invocation of python subprocess and added .flush() after data
	  sends.

Fri Oct 05 09:32:58 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/util.py: removed redundant imports

Fri Oct 05 09:12:20 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/util.py: removed redundant data size sending in IO.

Fri Oct 05 08:41:28 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/remote-filter.py,
	  src/indexserver/remote_filter.py: Changed to python friendly file
	  name.

Fri Oct 05 08:39:38 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/filterrunner.py,src/indexserver/remote-filter.py,
	  src/util.py: Snapshotting work in progress. Simple utility to
	  make a filter that runs a filter in a subprocess.

Thu Oct 04 14:40:48 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* libs/htmlparser/src/unicode.h,libs/htmlparser/src/xapian,
	  libs/htmlparser/src/xapian/unicode.h,
	  libs/htmlparser/src/xapian/visibility.h,
	  libs/htmlparser/src/xapian.h: Move xapian header files to a
	  subdirectory called xapian, and add a stub "xapian.h" file which
	  includes the neccessary header files.

Thu Oct 04 14:11:42 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* libs/htmlparser/src/namedentities.h,
	  libs/htmlparser/src/safeerrno.h,libs/htmlparser/src/strcasecmp.h,
	  libs/htmlparser/src/unicode.h,libs/htmlparser/src/utf8convert.cc,
	  libs/htmlparser/src/utf8convert.h,
	  libs/htmlparser/src/utf8itor.cc: More files needed from Xapian,
	  unedited.

Thu Oct 04 13:51:27 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* libs/: Add htmlparser source files, exactly as lifted from Xapian
	  HEAD.

Thu Oct 04 13:39:05 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/filespec.py: Added some comments about symlinks and the files
	  that the filespec yields.

Thu Oct 04 12:54:28 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/filespec.py: Tidied up some whitespace.

Thu Oct 04 12:53:03 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/simple_text_filter.py,
	  src/indexserver/w32com_ifilter.py: additions inadvertently
	  ommitted from last check in.

Thu Oct 04 12:51:10 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/simple_text_filter.py,src/w32com_ifilter.py: Moved filter
	  implementations to the indexserver directory since they're
	  invoked from there.

Thu Oct 04 12:17:45 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/dbspec.py,src/flax.py,src/schedulespec.py,src/templates.py,
	  src/w32com_ifilter.py: Whitespace fixes.

Thu Oct 04 09:52:57 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py,src/w32com_ifilter.py: typos

Thu Oct 04 09:48:54 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: Better exception handling. More
	  logging. Changed the stale test to be != rather than testing
	  whether the mtime is newer that than that last time we indexed.

Thu Oct 04 08:23:58 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: Added brackets in format_size.

Thu Oct 04 06:18:22 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: Skip files when a filter raises an
	  exception (and log).

Thu Oct 04 06:17:23 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/w32com_ifilter.py: Better error handling

Thu Oct 04 05:24:57 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py: Added cherrypy.expose to Collections.add

Wed Oct 03 18:42:57 BST 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py: import setuppaths after adding .. to
	  sys.path
	* utils/install_dependencies.py: Don't bother installing routes.

Wed Oct 03 17:33:01 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/indexserver/indexer.py: Convert a util.setup_sys_path that I
	  missed.

Wed Oct 03 17:18:38 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* README: removed reference to routes dependency

Wed Oct 03 17:13:35 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cp.conf,src/cpserver.py: Removed the depency on routes and
	  changes to do the object traversal without routes. (Note that
	  admin authentication is now required by default. You can disable
	  this by editing the cp.conf file or else user is "admin" pw is
	  "admin".)

Wed Oct 03 16:47:46 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/dbspec.py,src/doc_collection.py,src/flax_collections.py: Use
	  "import setuppaths" instead of util.setup_sys_path() - neater,
	  and ensures the path is only modified once.
	* src/cpserver.py: Import "setuppaths" to get paths setup for third
	  party modules if they're only locally installed.
	* src/setuppaths.py: New module which simply calls
	  util.setup_sys_path() when it's imported.  This is convenient
	  because it will only call it the first time it's imported, so we
	  don't end up repeatedly modifying sys.path.
	* src/util.py: Add "lib" to sys.path as well as "libs/xappy", since
	  this is where the new utils/install_dependencies.py script puts
	  them.
	* ChangeLog: Update.

Wed Oct 03 16:00:42 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* utils/install_dependencies.py: Add script which downloads the
	  dependencies and installs them locally to libs/

Wed Oct 03 15:06:11 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/templates/admin_banner.html: added
	  flax logo to admin banner

Wed Oct 03 13:05:04 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/templates/admin_banner.html: tidied
	  admin stuff a bit

Wed Oct 03 12:03:49 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/dbspec.py,src/indexserver/indexer.py,src/static/css/main.css,
	  src/templates/search_result.html,src/templates.py: added file
	  size to index metadata, and changed modification time to actual
	  value. Added to search results template.

Wed Oct 03 09:42:49 BST 2007  Richard Boulton <richard@lemurconsulting.com>

	* ChangeLog: Update.
	* src/flax.py: Add a missing comma.

Wed Oct 03 07:41:09 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/tw2server.py: Removing this file as it's not used, we can
	  resurrect it later if there's any reason to.

Wed Oct 03 06:14:10 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/flax.py,src/indexserver/indexer.py,
	  src/indexserver/indexserver.py,src/logclient.py,
	  src/logconfserver/,src/persist.py,src/scheduler.py,
	  src/schedulespec.py,src/util.py: Refactoring to simplify thread
	  usage. Added some logging calls. Added a new logger name. Delete
	  flax.flx to see the new logger in the web app (should find
	  another way of dealing with this).

Tue Oct 02 15:19:39 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* ChangeLog,src,src/indexserver,src/logconfserver: Update ChangeLog
	  and add svn:ignores for various generated files.

Tue Oct 02 12:19:06 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/scheduler.py: Made 60 seconds the default
	  delay for ScheduleIndexing.

Tue Oct 02 12:17:54 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/schedulespec.py: (This file inadvertently ommited form last
	  commit.) Implemented a simple scheduling scheme and web page
	  changes necessary to drive it. Minor refactoring to facilitate
	  code reuse. (NB, delete your flax.flx file after updating.)

Tue Oct 02 12:04:06 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/doc_collection.py,src/flax.py,src/persist.py,
	  src/scheduler.py,src/templates/collection_detail.html,
	  src/templates.py,src/util.py: Implemented a simple scheduling
	  scheme and web page changes necessary to drive it. Minor
	  refactoring to facilitate code reuse. (NB, delete your flax.flx
	  file after updating.)

Tue Oct 02 09:45:43 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/flax_collections.py: Took the logger out of the class
	  definition to avoid interfering with pickling.

Tue Oct 02 09:03:33 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py: Removed unnecessary import

Tue Oct 02 08:32:21 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/logconfserver/flaxlog.conf: workaround for Mac Python 2.5

Tue Oct 02 08:21:08 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py: corrected editing error

Tue Oct 02 08:11:40 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/img/flax.125trans.png: smaller logo

Tue Oct 02 05:38:21 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/flax_collections.py,src/indexserver/indexer.py,src/search.py:
	  Added some logging calls. Moved the xappy/xapian search
	  invocation out of the document collections.

Tue Oct 02 05:02:14 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/logconfserver/flaxlog.conf: Some renaming. Made a different
	  handler for the indexerlog

Tue Oct 02 04:44:10 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexserver.py: start the logconf listener

Tue Oct 02 04:20:37 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexserver.py,
	  src/logconfserver/logconfserver.py,src/pyroserver.py,src/util.py:
	  Moved run_server to util.py and got rid of pyroserver.py

Tue Oct 02 04:09:39 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/indexserver/indexserver.py,
	  src/logconfserver/filewatch.py,
	  src/logconfserver/logchangepublish.py,
	  src/logconfserver/logconf.py,src/logconfserver/logconfserver.py,
	  src/pyroserver.py: Changes to ensure that everything shuts down
	  cleanly on KeyboardInterrupt. Tidied up common bits of code.

Mon Oct 01 14:44:04 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/cpserver.py,src/flax_collections.py,src/static/css/main.css,
	  src/templates/search_result.html,src/templates.py: added page
	  navigation to search results

Mon Oct 01 14:11:24 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/persist.py: Added a mechanism to poll for
	  data change and dump the persitent data if need be.

Mon Oct 01 13:35:37 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/indexserver/indexserver.py,src/logclient.py:
	  Provide a mechanism for terminating listeners for the logconf
	  events.

Mon Oct 01 12:19:09 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/flax.py,src/indexserver/indexer.py,
	  src/indexserver/indexserver.py,src/logclient.py,src/templates.py:
	  Added a listener to control the subscriber for log configuration
	  changes and used that in the web server and indexserver. Mad the
	  log configuration property changes via the web app work with the
	  client/server log configuration stuff.

Mon Oct 01 12:14:04 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/logconfserver/logconf.py: typos and correct processing of
	  data.

Mon Oct 01 12:12:57 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/logconfserver/logchangepublish.py: Start the filewatcher in
	  __init__

Mon Oct 01 12:12:21 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/logconfserver/flaxlog.conf: Added sections for loggers we
	  plan to use.

Mon Oct 01 09:51:09 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/logconfserver/flaxlog.conf: Python 2.5 on Mac doesn't trim
	  space from [loggers] keys values, so it has been removed

Mon Oct 01 06:18:01 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* README: Updated startup notes.

Mon Oct 01 06:03:18 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/indexserver/indexserver.py,src/logclient.py,
	  src/logconfserver/flaxlog.conf,
	  src/logconfserver/logchangepublish.py,
	  src/logconfserver/logconf.py,src/logconfserver/logconfserver.py,
	  src/pyroserver.py: Used the pyro eventing mechanism to publish
	  changes in the log configuration.

Sun Sep 30 18:36:50 BST 2007  Richard Boulton <richard@lemurconsulting.com>

	* ChangeLog: Update
	* utils/log2cl.py: Cope with various different date formats in
	  existing changelog entries.

Sun Sep 30 16:45:54 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexserver.py: Added a sleep() to given the
	  logging configuration time to propogate before we try to use it.

Sun Sep 30 16:13:29 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py: use logconf client

Sun Sep 30 16:12:20 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver/indexer.py,src/indexserver/indexserver.py: use
	  pyroserver stuff and fix up sys.path

Sun Sep 30 16:11:20 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/pyroserver.py: utilities for starting pyro servers.

Sun Sep 30 16:10:39 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/logconfserver/filewatch.py,src/logconfserver/logconf.py,
	  src/logconfserver/logconfserver.py: logconf server, first pass

Sun Sep 30 16:09:01 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/logclient.py: Standardise logging configuration.

Sun Sep 30 13:19:23 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/logconfserver/filewatch.py,src/logconfserver/flaxlog.conf,
	  src/logconfserver/logconf.py: snapshot logconfserver work in
	  progress

Sun Sep 30 13:17:22 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexer.py,src/indexserver/indexer.py,
	  src/indexserver/indexserver.py,src/indexserver.py: moved files to
	  appropriate directory.

Sun Sep 30 13:16:19 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexserver,src/logconfserver: New directories for helper
	  programs.

Sun Sep 30 13:15:25 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexer.py,src/indexserver.py: Allowed for passing in the
	  logger object to the indexer.

Sun Sep 30 13:13:22 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/persist.py: tidy up whitespace

Fri Sep 28 14:27:11 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/templates/search.html,
	  src/templates/search_result.html,src/templates.py: Changes to
	  search results page

Fri Sep 28 12:29:47 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/static/css/main.css,src/templates/flax.html,
	  src/templates/search.html,src/templates/user_banner.html:
	  Redesigned search page

Fri Sep 28 09:25:28 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/dbspec.py: Consistent options for all the free text fields.

Fri Sep 28 08:42:42 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/cpserver.py,src/templates/flax.html,
	  src/templates/search_result.html,src/templates.py: Brought search
	  form into search results, and modified rendering code to support.

Fri Sep 28 05:49:46 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexer.py: Implemented removal of documents from the
	  database if they no longer have a corresponding file.

Thu Sep 27 18:55:31 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: used os.path.getmtime rather than os.stat stuff

Thu Sep 27 18:44:25 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: removed obsolete code for making static web
	  pages from the templates.

Thu Sep 27 18:42:52 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: corrected tman -> _tman

Thu Sep 27 18:39:52 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py: removed assigment to parameter in
	  start_web_server

Thu Sep 27 14:45:48 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/cpserver.py,src/templates.py: Implemented template
	  reloading/caching by passing around render functions rather than
	  template objects.

Thu Sep 27 14:24:33 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/doc_collection.py,src/indexer.py: Removed dbname arg from
	  do_indexing since this is obtainable from the document collection
	  in any case.

Thu Sep 27 13:56:42 BST 2007  Richard Boulton <richard@lemurconsulting.com>

	* utils/log2cl.py: Add script for updating the ChangeLog.

Thu Sep 27 13:53:32 BST 2007  Richard Boulton <richard@lemurconsulting.com>

	* ChangeLog: Update.

Thu Sep 27 11:16:45 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py: changed references to filter_settings to filters
	  Made a start on consistent error handling by subclassing from a
	  new class that provide methods for dealing with some error
	  situations.

Thu Sep 27 10:19:46 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py: Changed the error response for add.

Thu Sep 27 08:51:22 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* README: Added some notes about persistence.

Thu Sep 27 08:41:13 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py: Added command line options to load/save data.

Thu Sep 27 08:40:10 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/persist.py: Very simple persistence mechanism user the
	  standard shelve/pickle modules.

Thu Sep 27 08:39:19 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/flax.py: Got rid of the globals (except for options) and
	  moved the intialization of a fresh options object to a function.

Thu Sep 27 08:37:59 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/flax_collections.py: Used the collection update method,
	  rather than updating it's __dict__. Remove the .lower() prior to
	  parsing a query string.

Thu Sep 27 08:35:30 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/filespec.py: Ensured that paths is set to a  list when
	  inititialised as None.

Thu Sep 27 06:02:17 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py: removed unused local in main()

Wed Sep 26 14:08:32 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* src/flax_collections.py: added collection_names property
	* src/cpserver.py: search method now treats col = None as "search all"
	* src/templates.py: template handles col = None

Wed Sep 26 13:19:36 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexer.py: In Indexer.stale: used the first mtime field
	  rather than the list of them to get the document indexing time.

Wed Sep 26 13:03:17 UTC 2007  Tom Mortimer <tom@lemurconsulting.com>

	* tests,tests/sampledocs,tests/sampledocs/Changes.txt: added a test
	  document

Wed Sep 26 12:06:28 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: Provided for serving source files for
	  documents. Documents include a "collection" field, and this
	  togther with the document id is used to verify that the file is
	  one that was actually indexed at some point. This provides a form
	  of security (so that we're not serving arbitrary files, but we
	  need to think harder about whether this provides a loophole
	  allowing any files from the server to be downloaded). (this file
	  inadvertently ommitted from last checkin.)

Wed Sep 26 12:05:13 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/dbspec.py,src/doc_collection.py,
	  src/indexer.py: Provided for serving source files for documents.
	  Documents include a "collection" field, and this togther with the
	  document id is used to verify that the file is one that was
	  actually indexed at some point. This provides a form of security
	  (so that we're not serving arbitrary files, but we need to think
	  harder about whether this provides a loophole allowing any files
	  from the server to be downloaded).

Wed Sep 26 11:04:33 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: Took out the high maxlen arg to summarize when
	  rendering search results.

Wed Sep 26 11:03:25 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexer.py: Added a comment about the modification date
	  testing.

Wed Sep 26 09:58:30 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* README: Added some notes about starting the indexserver.

Wed Sep 26 07:47:46 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/dbspec.py,src/indexer.py: Added fields actions for "standard"
	  fields at db creation time. Used filename as document id, used
	  replace rather than add to put documents into the db. Changed the
	  indexer to check whether a file has changed and only filter when
	  this is so. Added the indexing time to the document to facilitate
	  this.

Wed Sep 26 04:49:54 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* LICENSE,src/filterDemo.py: Removed the filterDemo.py (which was
	  from the windows python extentions distribution). Updated the
	  LICENSE file to note the some code is based on that file.

Tue Sep 25 06:24:34 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: Checked that there is some 'content' keyed data
	  before we try to use it.

Tue Sep 25 06:22:11 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexer.py,src/indexserver.py: Split out the remoting stuff
	  from the indexing stuff for the indexserver.

Tue Sep 25 06:15:53 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/simple_text_filter.py: Changed the field for the main content
	  to be consistent with the filter spec.

Tue Sep 25 04:45:23 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/dbspec.py,src/doc_collection.py,
	  src/filterDemo.py,src/flax.py,src/flax_collections.py,
	  src/templates/search_result.html,src/templates.py: Moved the code
	  for rendering search resaults out of the web server and into the
	  template code. Moved the code for invoking the search out of the
	  web server and into the collections.

Mon Sep 24 13:44:04 BST 2007  Richard Boulton <richard@lemurconsulting.com>

	* src/dbspec.py: Add "import xappy" line, and make database
	  directory (and parents) if it doesn't already exist.
	* ChangeLog: Update.

Mon Sep 24 10:12:10 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/util.py,src/w32com_ifilter.py: Split gen_until_exception out
	  into util. Changed it to take an iterator (it's more useful that
	  way).

	  Added code to deal with structured storage, again based on the
	  w32com filter demo, and emmited blocks for fields for summary
	  information based where it's available.

Sun Sep 23 05:59:16 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/dbspec.py,src/doc_collection.py,src/indexspec.py,
	  src/w32com_ifilter.py: Renaming for better correspondence between
	  name and purpose.

Sun Sep 23 05:58:18 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexer.py: Split a line for better readability.

Sat Sep 22 05:37:24 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/w32com_ifilter.py: Added a call to pythoncom.CoInitialize so
	  that the filter can run happily in any thread.

Thu Sep 20 12:01:58 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/filespec.py,
	  src/templates/collection_detail.html,src/templates.py,
	  src/util.py: Getting the date/time related parts of a filespec to
	  function, and provided for setting them through the UI.

Wed Sep 19 08:26:20 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/collection_detail.html: commented out the yui stuff
	  as it's not currently used.

Wed Sep 19 07:40:31 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/: Refactored to (hopefully) de-spaghetti a bit.

	  Made a start on indexing options for collections.

Tue Sep 18 13:05:31 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexer.py: Addd some docstrings; renamed methods to make
	  intended public interface clear; renamed a method param to be
	  consistent with invocation.

Tue Sep 18 12:39:09 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/indexer.py: Avoided using a list for the fields property of
	  unprocessed document. fields can be any iterator so we just
	  starmap xappy.Field over the filter.

Tue Sep 18 11:18:01 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/collection.py,src/flax.py,src/indexer.py: Allowed for passing
	  format->filter mapping to the indexer.

	  Made the call to the indexer one way.

Tue Sep 18 11:16:55 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/w32com_ifilter.py: added start fields to filter.

Tue Sep 18 06:54:35 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/simple_text_filter.py: Simple filter that breaks text files
	  into paragraphs.

Mon Sep 17 15:36:55 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/indexer.py,src/util.py: Added psyco
	  invocation to web server and indexer.

Mon Sep 17 15:18:30 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* README,src/README: Moved README to top level directory.

Mon Sep 17 13:09:40 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/templates.py: Used global formats setting for
	  rendering of the collection detail templates.

Mon Sep 17 13:02:49 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py: removed a diagnostic print

Mon Sep 17 13:01:53 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/collection.py,src/cpserver.py,src/flax.py,src/indexer.py,
	  src/templates/options.html,src/templates.py: Pulled most of the
	  global data into a single objects and modified the global options
	  rendering and processing to deal with this object.

	  Added initial code for the indexer.

Mon Sep 17 10:51:01 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/util.py: General flax utilities.

	  Added a function to set up sys.path to find xappy.

Mon Sep 17 10:49:43 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/collection.py,src/cpserver.py: Pulled the indexing stuff out
	  of the collection and put it in a new class intended to be called
	  remotely.

	  Added the necessary Pyro invocations for the remoting.

Mon Sep 17 10:48:19 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: Added rendering for format/filter options.

Mon Sep 17 10:47:01 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/README: Noted dependency on docutils for auto-generated api
	  docs.

Mon Sep 17 10:44:32 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/options.html: Added a section for specifying how a
	  format maps to a filter.

Thu Sep 13 11:04:22 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/w32com_ifilter.py: refactored to get rid of duplication.

Thu Sep 13 10:28:25 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/w32com_ifilter.py: A simple filter that uses LoadIFilter to
	  get make a filter for a file and then returns a generator that
	  yeield annotated chunks of text from the file.

Wed Sep 12 15:43:21 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* LICENSE: Licensing.

Wed Sep 12 15:08:40 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/filterDemo.py: Changed "reduce(operator.add..." to sum - the
	  former errors with no initial value if the list is empty.

Wed Sep 12 15:05:27 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/filterDemo.py: This is the original version of the
	  ifilterDemo from the python windows extension (which doesn't work
	  for me at the moment).

	  Snapshotting the original.

Tue Sep 11 09:38:38 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: Added docstrings.

Mon Sep 10 10:45:47 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/README,src/cpserver.py,src/epydoc.conf: Added restructured
	  text docstrings to code in cpserver, together with a
	  configuration file for epydoc to generator api documentation from
	  these. Added a note to the REDAME about this.

	  Refectored Admin and Top to get rid of some duplication.

	  Pulled the startup stuff into a separate function.

Mon Sep 10 10:43:14 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/options.html: Changed the help text to include a
	  warning about potentially generating lots of logging data.

Sun Sep 09 06:03:12 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py: Made indentation consistent.

	  Moved all template references to the start up code, controllers
	  now take all their templates as initialization arguments.

	  Pulled creation of controllers out of the setup_routes.

Sat Sep 08 07:46:01 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/collection.py,src/cpserver.py,src/static/css/main.css,
	  src/templates/admin_banner.html,
	  src/templates/advanced_search.html,
	  src/templates/collection_detail.html,src/templates/flax.html,
	  src/templates/options.html,src/templates/search.html,
	  src/templates.py: Added an advanced search form.

	  Added a section on logging options to the global options page.

Sat Sep 08 04:14:28 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/README: Spelling.

Fri Sep 07 17:13:39 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/README: Some basic information about Flax.

Fri Sep 07 12:55:20 UTC 2007  Richard Boulton <richard@lemurconsulting.com>

	* src: Add *.pyc to ignores.

Fri Sep 07 07:59:04 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py,src/templates/collections.html,
	  src/templates/search_result.html,src/templates.py: Sensible
	  redirection after actions on collections.

	  Changed some variable names to avoid slight nastiness with extra
	  keyword args arriving from the framework.

Thu Sep 06 17:56:22 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src, src/collection.py, src/cpserver.py, src/templates: Ignores
	  for semantic.cache.

	  Reflect secore -> xappy change.

	  Mininal indexing and searching capability to investigate proper
	  search result formatting.

Thu Sep 06 17:50:01 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/filespec.py: Changes to support prototyping, ignore the date-
	  related specifications, and get the format matching to work.

Thu Sep 06 17:47:33 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: Added an optional results arg for the search
	  results template renderer.

Thu Sep 06 17:46:41 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/search_result.html: Added a place-holder for actual
	  search results.

Thu Sep 06 10:23:17 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/collection.py, src/cpserver.py,
	  src/templates/collection_detail.html,
	  src/templates/collections.html, src/templates.py: Refactored the
	  cherrypy server to use the cherrypy server routes dispatcher.
	  Also some minor changes to the templates, to support new urls.

	  Made a start on experimenting with some search functionality.
	  This isn't intended to be in the final form this will take. I
	  just want a prototype in order to play with the rendering of
	  search results.

Wed Sep 05 10:22:14 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/test/testfilespec.py: reinstated code inadvertenly removed
	  during rename.

Wed Sep 05 08:30:44 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cp.conf: basic authentication for admin pages.

Wed Sep 05 05:41:48 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cpserver.py, src/templates/collections.html: Ensured that the
	  redirect on posting to the collections list works.

Wed Sep 05 05:17:48 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/cp.conf, src/cpserver.py: First pass at using cherrypy as the
	  web server.

Wed Sep 05 05:16:26 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: Changed the url for the individual collection
	  links from the collections list page.

Wed Sep 05 03:43:43 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/filespec.py: various changes, to at least get the iterator to
	  work.

Wed Sep 05 03:42:59 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/collection_detail.html, src/templates/flax.html,
	  src/templates.py: Allowed for templates to insert different stuff
	  in the common document head.

Wed Sep 05 03:40:12 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/test/filespec.py, src/test/testfilespec.py: renaming

Mon Sep 03 07:07:15 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/static/, src/templates/admin_banner.html,
	  src/templates/collection_detail.html,
	  src/templates/collections.html, src/templates/flax.html,
	  src/templates/options.html, src/templates/search.html,
	  src/templates.py, src/tw2server.py: various additions and layout
	  improvements.

Mon Sep 03 06:40:22 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/filespec.py: A class for specifying the set of files of a
	  document collection.

Mon Sep 03 06:39:20 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/test, src/test/filespec.py: tests directory

Mon Sep 03 06:37:13 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/static/js/yui/README, src/static/js/yui/assets,
	  src/static/js/yui/build, src/static/js/yui/docs,
	  src/static/js/yui/examples, src/static/js/yui/index.html,
	  src/static/js/yui/tests: added yui for the calendar controls

Mon Sep 03 06:36:10 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/static/js, src/static/js/yui: added yui for the calendar
	  controls

Mon Sep 03 06:18:46 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/static/css/main.css: layout improvements for forms

Fri Aug 24 13:40:22 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/collection.py, src/templates/collection_detail.html,
	  src/templates/search.html, src/templates.py, src/tw2server.py:
	  Made collections more like a dictionary.

	  Cosmetic layout changes in the html.

Thu Aug 23 06:31:26 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/, src/templates/admin_banner.html,
	  src/templates/admin_search.html,
	  src/templates/admin_search_result.html,
	  src/templates/search.html, src/templates/search_result.html,
	  src/templates/user_banner.html, src/templates.py,
	  src/tw2server.py: Templates for users as well as admins. Moved
	  urls around to accommodate.

Wed Aug 22 16:11:28 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/tw2server.py: Allowed for updating collections  by posting to
	  collection detail pages.

Wed Aug 22 16:10:24 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/collection_detail.html: More elements for
	  collection details.

Wed Aug 22 16:09:55 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: More collection detail rendering.

Wed Aug 22 16:09:01 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/static/css/main.css: layout for form labels

Wed Aug 22 16:08:31 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/collection.py: added paths and formats

Wed Aug 22 07:11:15 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/admin_search.html, src/templates/collections.html,
	  src/tw2server.py: Creation of new collections implemented

Wed Aug 22 05:56:31 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/tw2server.py: removed a diagnostic print

Tue Aug 21 20:47:15 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/tw2server.py: removed diagnostic prints

Tue Aug 21 20:44:34 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/admin_search.html: tidying

Tue Aug 21 19:42:34 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/admin_banner.html, src/templates/collections.html,
	  src/templates/flax.html, src/templates.py, src/tw2server.py:
	  Added a web server.

	  Made changes to the templates to make the urls link properly
	  (this means that the links between the html files written are not
	  so good, but no real need for those now anyhow).

Tue Aug 21 19:40:38 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/static/css/main.css: minor layout/rendering changes

Tue Aug 21 19:39:56 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/collection.py: added more structure to dummy collection type

Tue Aug 21 07:12:39 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: More dummy collection properties

	  render html from command line.

Tue Aug 21 06:08:26 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/collection_detail.html: typo

Mon Aug 20 21:48:52 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/collection.py, src/templates.py: sorted rendering of
	  collection descriptions, provided for arbitrary collection
	  atributes.

Mon Aug 20 21:32:42 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates.py: Added search result template

Mon Aug 20 21:23:06 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/admin_banner.html: corrected comments

Mon Aug 20 17:31:14 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/templates/index.html: minimal index template.

Mon Aug 20 17:30:34 UTC 2007  Paul Rudin <paul@rudin.co.uk>

	* src/, src/collection.py, src/static, src/static/css,
	  src/static/css/main.css, src/static/img/, src/templates/,
	  src/templates.py: Start of some HTMLTemplates and associated
	  rendering code.
